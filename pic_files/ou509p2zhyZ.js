/*!CK:462596028!*//*1439783658,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LfzUa"]); }

__d('ReactComposerPhotoLegacyLimitExceededDialog',['Dialog','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={show:function(k){var l=i._("Too Many Photos"),m=i._("Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages.",[i.param('maxselect',k)]);new h().setTitle(l).setBody(m).setButtons(h.OK).setModal(true).show();}};f.exports=j;},null);
__d('ReactComposerVideoLegacyLimitExceededDialog',['ErrorDialog','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={show:function(){h.show(i._("Too many files"),i._("Please select only one video file at a time."));}};f.exports=j;},null);
__d('ReactComposerVideoUploadActions',['ReactComposerDispatcher','ReactComposerVideoUploadActionType','ReactComposerVideoUploadStore'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();c('ReactComposerVideoUploadStore');var j={setUploader:function(k,l){h.dispatch({composerID:k,type:i.VIDEO_SET_UPLOADER,uploader:l});},add:function(k,l){h.dispatch({composerID:k,type:i.VIDEO_UPLOAD_ADD,file:l});},remove:function(k){h.dispatch({composerID:k,type:i.VIDEO_UPLOAD_REMOVE});}};f.exports=j;},null);
__d('ReactComposerMediaUtils',['ReactComposerPhotoActions','ReactComposerPhotoLegacyLimitExceededDialog','ReactComposerPhotoUploadActions','ReactComposerPhotoUploadStore','ReactComposerVideoLegacyLimitExceededDialog','ReactComposerVideoUploadStore','ReactComposerVideoUploadActions','VideoUploadFeatureDetector','VideoUploadConfig','VideoUploadFile','Map','PUWMethods','uniqueID'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u={clearInput:function(v){var w=this.getFileNamesFromFileInput(v.getInput());if(!u.hasVideos(w))v.clear();},getFileNames:function(v){var w=[];for(var x=0;x<v.length;x++)w.push(v[x].name);return w;},getFileNamesFromFileInput:function(v){if(o.supportsFileAPI()){return this.getFileNames(v.files);}else return [v.value.split('/').pop().split('\\').pop()];},hasVideos:function(v){if(p.allowMultimedia)return false;var w=0;v.forEach(function(x){var y=x.indexOf('.')!==-1?x.split('.').pop().toLowerCase():'';if(!!p.videoExtensions[y])w++;});return w>0;},uploadVideo:function(v,w){if(k.getUploads(v).size>0)j.removeAllPhotoUploads(v);n.add(v,w);},uploadPhotos:function(v,w,x,y,z,aa){var ba=x.isUploadLimitExceeded(y,w);if(ba){i.show(x.getMaxSelectableFilesCount(y));return;}var ca=w?w.length:1;if(ca<1)return;if(m.getVideo(v))n.remove(v);j.photosSelect(v,ca,z);aa&&aa();},uploadPhotosOrVideoFromTarget:function(v,w,x,y){var z=this.getFileNamesFromFileInput(w);if(this.hasVideos(z)){if(w.files&&w.files.length>1){l.show();}else this.uploadVideo(v,q.fromFileInput(w));}else this.uploadPhotos(v,w.files,x,y,s.FILE_SELECTOR,function(){x&&x.upload(w);});},uploadPhotosOrVideo:function(v,w,x,y){var z=this.getFileNames(w);if(this.hasVideos(z)){if(w&&w.length>1){l.show();}else this.uploadVideo(v,q.fromFile(w[0]));}else this.uploadPhotos(v,w,x,y,s.DRAGDROP,function(){w.forEach(function(aa){aa.uploadID=t();aa.filename='';});x.enqueueAsyncUploadRequest(v,w,{});});},onImageEdited:function(v,w,x,y){var z=k.getUploads(v),aa=z.find(function(ea){return (ea.photoID===y.fbid||ea.originalPhotoID===y.fbid);}),ba=k.getUploadIndex(v,aa.id);h.removePhoto(v,aa.photoID,aa.id);var ca=y.blob;ca.uploadID=t();ca.filename=aa.filename;var da=new r([[ca.uploadID,ba]]);w&&w.enqueueAsyncUploadRequest(v,[ca],{data:{original_fbid:y.fbid},indexMap:da});j.photosSelect(v,1,s.METHOD_EDITOR);h.finishPhotoEdit(v);}};f.exports=u;},null);