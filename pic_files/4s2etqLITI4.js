/*!CK:4110123212!*//*1445222259,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["GgCJu"]); }

__d('AdsInterestsBrowseDataSource',['AdsSearchBrowseUtils','CurrentLocale','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=[],l,m;function n(r){l=o(r);m=h.generateTreeData(l);while(k.length){var s=k.pop();s();}k=[];}function o(r){var s,t,u,v={},w,x;for(var y=0;y<r.length;y++){s=r[y];t=s.parent_category;u=s.name;if(s.path&&s.path.length){w=s.path.slice();w.pop();}else w=null;if(w&&w.length>0){x=w.join(' > ')+' > '+u;}else{w=null;x=u;}v[x]={id:s.id,key:x,uniqueID:s.id,name:s.name,parentName:t,reach:s.audience_size,description:s.description,path:w,keywords:s.keywords,topic:s.topic};}return v;}var p;function q(r,s){'use strict';if(p)return p;if(r){this.dao=r;this.options=s||{};}}q.prototype.resetTreeData=function(){'use strict';m=null;};q.prototype.getTreeData=function(r){'use strict';if(m){this.$AdsInterestsBrowseDataSource1(r);}else{k.push(this.$AdsInterestsBrowseDataSource1.bind(this,r));this.$AdsInterestsBrowseDataSource2();}};q.prototype.getSearchDataElem=function(r){'use strict';if(l)return l[r];};q.prototype.dataToEntry=function(r){'use strict';var s=new j({uniqueID:r.uniqueID,title:r.name});s.id=r.id;s.key=r.key;s.numLeafCategories=r.numLeafCategories;s.path=r.path;s.reach=r.reach;s.name=r.name;s.description=r.description;s.source=r.source;s.topic=r.topic;s.isInHierarchy=true;return s;};q.prototype.getDao=function(){'use strict';return this.dao;};q.prototype.$AdsInterestsBrowseDataSource2=function(){'use strict';if(k.length!==1||!this.dao)return;this.dao.fetch.adInterestCategory.one(function(r){n(r);},{locale:i.get(),fetch_interest_groups:this.options.fetchInterestGroups});};q.prototype.$AdsInterestsBrowseDataSource1=function(r){'use strict';r(m);};q.prototype.$AdsInterestsBrowseDataSource3=function(r){'use strict';r(l);};q.getInstance=function(r,s){if(!p)p=new q(r,s);return p;};f.exports=q;},null);
__d('AdsInterestsSuggestionsDataSource',['AdInterfacesUiLogger','CurrentLocale','PublishedLocales','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m=20;function n(o){'use strict';if(o)this.dao=o;}n.prototype.getSuggestions=function(o,p){'use strict';if(!this.dao)return;this.dao.fetch.adInterestSuggestion.one(this.getSuggestionsCB.bind(this,p),{interest_list:o,offset:0,limit:m,locale:i.get()});var q=i.get();if(!(q in j))q='en_US';};n.prototype.getSuggestionsCB=function(o,p){'use strict';var q=p||[];if(!(q instanceof Array))return;var r=q.map(function(u){return {fbid:u.id,name:u.name};});h.log('unified_interest_sugggestions_returned',{results:r});var s,t=q.map(function(u,v){s=new k({uniqueID:u.id,title:u.name,order:v});s.name=u.name;s.reach=u.audience_size;s.path=u.path;if(u.path&&u.path.length){s.path=u.path.slice();s.path.pop();s.isInHierarchy=true;}s.description=u.description;return s;});o(t);};n.getInstance=function(o){if(!l)l=new n(o);return l;};f.exports=n;},null);
__d('AdsInterestsValidationDataSource',['SearchableEntry','CurrentLocale'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j;function k(l){'use strict';if(l)this.dao=l;}k.prototype.getMetadata=function(l,m,n){'use strict';if(!this.dao)return;this.dao.fetch.adInterestValid.one(this.getInterestsCB.bind(this,m),{interest_list:l,ignore_case:!n,locale:i.get()});};k.prototype.getMetadataFromFBID=function(l,m){'use strict';if(!this.dao)return;this.dao.fetch.adInterestValid.one(this.getInterestsCB.bind(this,m),{interest_fbid_list:l,locale:i.get()});};k.prototype.getInterestsCB=function(l,m){'use strict';var n=m||[];if(!(n instanceof Array))return;var o,p=[];n.forEach(function(q){if(!q.valid)return;o=new h({uniqueID:q.id,title:q.name});o.name=q.name;o.reach=q.audience_size;o.path=q.path;if(q.path&&q.path.length){o.path=q.path.slice();o.path.pop();o.isInHierarchy=true;}o.description=q.description;o.topic=q.topic;p.push(o);});l(p);};k.getInstance=function(l){if(!j)j=new k(l);return j;};f.exports=k;},null);
__d('AudienceInterestsSuggestionsDataSource',['CurrentLocale','GraphAPI','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=20;l.prototype.getSuggestions=function(m,n,o){i('2.4').search('audienceinterestsuggestion').get({interest_list:m,offset:0,limit:k,locale:h.get()}).done((function(p){return this.getSuggestionsCB(n,p.data);}).bind(this),function(p){return false;});};l.prototype.getSuggestionsCB=function(m,n){var o=n||[];if(!(o instanceof Array))return;var p,q=o.map(function(r){p=new j({uniqueID:r.id,title:r.name});p.name=r.name;p.reach=r.audience_size;p.path=r.path;if(r.path&&r.path.length){p.path=r.path.slice();p.path.pop();p.isInHierarchy=true;}p.description=r.description;p.topic=r.topic;return p;});m(q);};function l(){}f.exports=l;},null);
__d('AudienceInterestsValidationDataSource',['CurrentLocale','GraphAPI','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();k.prototype.getMetadata=function(l,m,n){i('2.4').search('audience_interest_validation').get({interest_list:l,ignore_case:!n,locale:h.get()}).done((function(o){return this.getInterestsCB(m,o.data);}).bind(this),function(o){return false;});};k.prototype.getMetadataFromFBID=function(l,m){i('2.4').search('audienceinterestvalidation').get({interest_fbid_list:l,locale:h.get()}).done((function(n){return this.getInterestsCB(m,n.data);}).bind(this),function(n){return false;});};k.prototype.getInterestsCB=function(l,m){var n=m||[];if(!(n instanceof Array))return;var o,p=[];n.forEach(function(q){if(!q.valid)return;o=new j({uniqueID:q.id,title:q.name});o.name=q.name;o.reach=q.audience_size;o.path=q.path;if(q.path&&q.path.length){o.path=q.path.slice();o.path.pop();o.isInHierarchy=true;}o.description=q.description;o.topic=q.topic;p.push(o);});l(p);};function k(){}f.exports=k;},null);
__d('AdsInterestsSearchSource',['AbstractSearchSource','AdsCreateFlowQueryLimits','AdsSearchBrowseUtils','CurrentLocale','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n,o;m=babelHelpers.inherits(p,h);n=m&&m.prototype;function p(q,r){'use strict';n.constructor.call(this);if(o){return o;}else{this.dao=q;this.options=r||{};return this;}}p.prototype.searchImpl=function(q,r,s){'use strict';if(!q){r([],q);return;}this.dao.fetch.adInterest.one((function(t){var u=[],v=t.data||t,w=q.toLowerCase();for(var x=0;x<v.length;x++){var y=v[x],z=y.id,aa=y.name,ba=new l({uniqueID:z,title:aa,order:x});ba.disambiguationCategory=y.disambiguation_category;ba.name=y.name;ba.reach=y.audience_size;ba.matchArray=j.getMatchedIndexArray(w,aa.toLowerCase());ba.path=y.path;if(y.path&&y.path.length){ba.path=y.path.slice();ba.path.pop();ba.isInHierarchy=true;}ba.description=y.description;ba.topic=y.topic;u.push(ba);if(u.length>i.TYPEAHEAD_LIMIT)break;}r(u,q);}).bind(this),{q:q,locale:k.get(),whitelisted_only:this.options.whitelistedInterestsOnly});};p.getInstance=function(q,r){if(!o)o=new p(q,r);return o;};f.exports=p;},null);
__d("AdsPreferencesConstants",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={CATEGORY_FILTERS:{NONE:"none",PAGE_LIKES:"page_likes",APP_INSTALLS:"app_installs",AD_CLICKS:"add_clicks",USER_ADDED:"user_added",BEHAVIORS:"behaviors",DEMOGRAPHICS:"demographics"}};f.exports=h;},null);
__d('AdsSBTokenizerExpandableListOld.react',['AdsSBAreaClicked','AdsSBTokenizerConstants','AdsInterestsEditButtons.react','AdsSBTokenizerPlusIcon.react','AdsSBTokenizerWhiteBox.react','ContextualLayer.react','ScrollableArea.react','React','ReactLayeredComponentMixin','AdInterfacesUiLogger','AdsSBTokenizerCheckBox.react','AdsFlexibleTargetingQETestConstant','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=s.NEW_SELECTION_STYLE,w=s.NEW_DROPDOWN_HEIGHT,x=o.PropTypes,y=23,z=15,aa=32,ba=i.TYPEAHEAD.HEIGHT,ca=i.WHITE_BOX.WIDTH,da,ea,fa=o.createClass({displayName:'AdsSBTokenizerExpandableListOld',mixins:[p],propTypes:{allowEdit:x.bool,data:x.array,dataSource:x.object.isRequired,className:x.string,onAddEntryAttempt:x.func,onRemoveEntryAttempt:x.func,openToPath:x.func,hidden:x.bool,selectedEntryIDs:x.object,uniqueID:x.string.isRequired,width:x.number.isRequired,showWhiteBox:x.bool,showPlusIcon:x.bool,rowHeight:x.number,reportedInterests:x.object,addReportedInterest:x.func,deleteReportedInterest:x.func,cfSection:x.string,initialAutoExpandEntryID:x.string,deltaObjectID:x.string,targetingSpecField:x.string},getDefaultProps:function(){return {rowHeight:aa,showWhiteBox:true,showPlusIcon:true};},getInitialState:function(){return {data:this.props.data||[]};},dataRetrieved:function(ha){if(!this.isMounted())return;this._expandChosenEntry(ha);this.setState({data:ha||[]});},_expandChosenEntry:function(ha){if(!this.props.initialAutoExpandEntryID)return;var ia=(ha||[]).find((function(ja){if(String(ja.uniqueID)===this.props.initialAutoExpandEntryID)return true;if(ja.children)this._expandChosenEntry(ja.children);return false;}).bind(this));if(ia)this._toggleExpand(ia);},componentDidMount:function(){this._retrieveData();},componentWillReceiveProps:function(ha){if(ha.data&&ha.data!==this.state.data)this.setState({data:ha.data});},componentDidUpdate:function(){if(da&&da>=this.props.rowHeight){da=da-this.props.rowHeight;this.refs&&this.refs.scrollArea&&this.refs.scrollArea.getArea().setScrollTop(da);ea=this.props.openPath;da=0;}},_retrieveData:function(){this.props.dataSource.resetTreeData&&this.props.dataSource.resetTreeData();this.props.dataSource.getTreeData(this.dataRetrieved);},render:function(){return o.createElement('div',{ref:'root'});},renderLayers:function(){if(this.props.hidden)return {};if(this.props.openPath&&this.props.openPath!=ea){da=0;this._openToPath(this.props.openPath,this.state.data);}var ha={level:0},ia=this.state.data.map(this._renderRow.bind(this,ha),this),ja=u("_6oz"+(' '+"clearfix"),this.props.className),ka={width:this.props.width},la={width:this.props.width,maxHeight:ba},ma;if(this._shouldShowWhiteBox(this.state.highlightedRow)){ma=o.createElement('div',{className:"_6o-"},o.createElement(l,babelHelpers._extends({},this.props,{info:this.state.highlightedRow,type:i.ACTIVE_STATES.BROWSE,deltaObjectID:this.props.deltaObjectID,selectedEntryIDs:this.props.selectedEntryIDs,targetingSpecField:this.props.targetingSpecField})));la.width=this.props.width+ca;}var na=o.createElement('div',{className:ja,onMouseDown:this._onMouseDown,onMouseLeave:this._onUnhighlight,style:la},o.createElement('div',{className:(!w?"_6p4":'')+(w?' '+"_18ki":''),style:ka,'data-testid':this.props.uniqueID+'_browse_list'},o.createElement(n,{ref:'scrollArea',width:this.props.width},o.createElement('ul',{className:"_6p5",style:{width:this.props.width-1}},ia)),ma));return {content:o.createElement(m,{alignment:'left',contextRef:(function(){return this.refs.root;}).bind(this),position:'below',shown:!this.props.hidden},na)};},_openToPath:function(ha,ia,ja){ja=ja?ja:0;var ka=ja<ha.length?ha[ja]:null;for(var la=0;la<ia.length;la++){var ma=ia[la];if(ka==ma.name){ma.listOpened=true;da+=(this.props.rowHeight+1)*(la+1);if(ma.children)this._openToPath(ha,ma.children,ja+1);}else ma.listOpened=false;}},_renderRow:function(ha,ia,ja){if(!ia||ia.length===0)return;if(ia instanceof Array&&ia.length)ia=ia[0];if(ia.invalid)return;var ka,la=ha.level,ma=ha.rowColor?ha.rowColor:la===0&&ja%2===0,na=ia.children,oa=this.props.selectedEntryIDs||{},pa={level:la+1,rowColor:ma,markAllAsSelected:ia.uniqueID in oa||ha.markAllAsSelected};if(na&&ia.listOpened)ka=na.map(this._renderRow.bind(this,pa),this);var qa=ia.uniqueID in oa||ia.id in oa||ha.markAllAsSelected,ra=o.createElement(ga,{allowEdit:this.props.allowEdit,data:ia,level:ha.level,toggleExpand:this._toggleExpand,index:ja,onHighlight:this._onHighlight,onUnhighlight:this._onUnhighlight,rowColor:ma,highlighted:this.state.highlightedRow===ia,noBorder:la===0&&!ia.listOpened,rowDisabled:qa,addEntry:this._addEntry,removeEntry:this._removeEntry,openToPath:this.props.openToPath,refreshBrowseData:this._retrieveData,dataSource:this.props.dataSource,showWhiteBox:this._shouldShowWhiteBox(ia),showPlusIcon:this.props.showPlusIcon,rowHeight:this.props.rowHeight,uniqueID:this.props.uniqueID}),sa=o.createElement('ul',{className:"_6p6"},ka);return [ra,sa];},resetList:function(){if(this.state.data&&this.state.data.length)this.state.data.forEach(this._closeChildren);},_closeChildren:function(ha){if(!ha)return;ha.listOpened=false;if(ha.children)ha.children.forEach(function(ia){this._closeChildren(ia);},this);},_toggleExpand:function(ha){if(!ha)return;if(ha.children)if(ha.listOpened){ha.listOpened=false;this.props.openToPath&&this.props.openToPath();}else{var ia=ha.path?ha.path.slice():[];ia.push(ha.name);this.props.openToPath&&this.props.openToPath(ia);}},_addEntry:function(ha){if(!ha)return;var ia=this.props.dataSource.dataToEntry(ha);q.log(this.props.uniqueID+'_select_from_browse',{fbid:ia.getUniqueID(),name:ia.getTitle(),cf_section:this.props.cfSection});this.props.onAddEntryAttempt&&this.props.onAddEntryAttempt(ia);},_removeEntry:function(ha){if(!ha)return;var ia=this.props.dataSource.dataToEntry(ha);this.props.onRemoveEntryAttempt&&this.props.onRemoveEntryAttempt(ia);},_onHighlight:function(ha){this.setState({highlightedRow:ha});},_onUnhighlight:function(){this.setState({highlightedRow:null});},_shouldShowWhiteBox:function(ha){return !!(this.props.showWhiteBox&&ha&&(ha.description||ha.source||ha.reach));}}),ga=o.createClass({displayName:'ExpandableRowView',propTypes:{allowEdit:x.bool,data:x.object.isRequired,rowColor:x.bool,noBorder:x.bool,onUnhighlight:x.func,addEntry:x.func,refreshBrowseData:x.func,removeEntry:x.func,openToPath:x.func,dataSource:x.object,showWhiteBox:x.bool,showPlusIcon:x.bool,rowHeight:x.number,uniqueID:x.string},getDefaultProps:function(){return {showPlusIcon:true};},componentDidMount:function(){if(this.props.dataSource.treedata&&this.props.dataSource.treedata.length==1&&this.props.toggleExpand)this.props.toggleExpand(this.props.data);},getInitialState:function(){return {plusIconHovered:this.props.highlighted&&!this._hasChildren()};},render:function(){var ha=this._hasChildren(),ia="_6p8"+(' '+"clearfix")+(this.props.highlighted?' '+"_6p9":'')+(this.props.rowDisabled?' '+"_6pa":'')+(ha?' '+"_6pb":'')+(v?' '+"_18kj":''),ja={height:this.props.rowHeight,lineHeight:this.props.rowHeight-1+'px'},ka={height:this.props.rowHeight-1},la="_6pc"+(ha&&!v?' '+"_6pd":'')+(v?' '+"_4b91":''),ma={width:y+this.props.level*z,height:this.props.rowHeight},na;if(ha)na="_6pe"+(this.props.data.listOpened?' '+"_6pf":'')+(!this.props.data.listOpened?' '+"_6pg":'')+(' '+"_6pq");var oa;if(this.props.data.numLeafCategories)oa=o.createElement('span',{className:"_6pr"},this.props.data.numLeafCategories);var pa;if(this.props.allowEdit&&this.props.highlighted)pa=o.createElement('div',{className:"_5m4n"},o.createElement(j,{data:this.props.data,dataSource:this.props.dataSource,refreshBrowseData:this.props.refreshBrowseData}));var qa=this.props.data;return (o.createElement('li',{className:ia},o.createElement('div',{className:la,onMouseDown:this._onArrowMouseDown,onMouseEnter:v?this._onListMouseEnter:this._onListMouseLeave,onMouseLeave:v?this._onListMouseLeave:null,style:ma,'data-testid':this.props.uniqueID+'_browse_arrow'},o.createElement('div',{className:na})),o.createElement('div',{style:ja,className:"_6ps",'data-testid':this.props.uniqueID+'_browse_row'},o.createElement('div',{className:"_6pt",onMouseDown:this._onListMouseDown,onMouseEnter:this._onListMouseEnter,style:ka},o.createElement('div',{className:"_6p_"},this.props.data.name),oa,pa,this.prop),qa.unselectable||!this.props.showPlusIcon?o.createElement('span',null):this._getIcon()),o.createElement('div',{className:this.props.showWhiteBox?"_5oe8":''})));},_getIcon:function(){if(v)return (o.createElement(r,{checked:this.props.rowDisabled,hovered:this.state.plusIconHovered||this.props.highlighted&&!this._hasChildren(),onMouseEnter:this._onPlusIconMouseEnter,onMouseLeave:this._onPlusIconMouseLeave,onMouseDown:this._onPlusIconMouseDown}));return (o.createElement(k,{hidden:this.props.rowDisabled,hovered:this.state.plusIconHovered||this.props.highlighted&&!this._hasChildren(),onMouseEnter:this._onPlusIconMouseEnter,onMouseLeave:this._onPlusIconMouseLeave,onMouseDown:this._onPlusIconMouseDown}));},_hasChildren:function(){var ha=this.props.data.children||[];return ha.length>0;},_onArrowMouseDown:function(){this._onMouseDown();if(v&&!this._hasChildren())this._onListMouseDown();this.props.toggleExpand&&this.props.toggleExpand(this.props.data);},_onListMouseDown:function(){this._onMouseDown();if(this.props.data.unselectable||this._hasChildren()){this.props.toggleExpand&&this.props.toggleExpand(this.props.data);}else if(this.props.rowDisabled){this.props.removeEntry&&this.props.removeEntry(this.props.data);}else this.props.addEntry&&this.props.addEntry(this.props.data);},_onListMouseEnter:function(){this.props.onHighlight&&this.props.onHighlight(this.props.data);},_onListMouseLeave:function(){this.props.onUnhighlight&&this.props.onUnhighlight();},_onPlusIconMouseDown:function(){this._onMouseDown();if(this.props.rowDisabled){this.props.removeEntry&&this.props.removeEntry(this.props.data);}else this.props.addEntry&&this.props.addEntry(this.props.data);},_onPlusIconMouseEnter:function(){this._hasChildren()&&this.setState({plusIconHovered:true});},_onPlusIconMouseLeave:function(){this._hasChildren()&&this.setState({plusIconHovered:false});},_onMouseDown:function(){h.setAreaClicked(this.props.uniqueID,true);}});f.exports=fa;},null);
__d('AdsSBTokenizerModeButtons.react',['React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'AdsSBTokenizerModeButtons',propTypes:{onSuggestionsButtonMouseDown:k.func,onBrowseButtonMouseDown:k.func,suggestionButtonEnabled:k.bool,uniqueID:k.string.isRequired},render:function(){var m="_4-97"+(' '+"_xke")+(!this.props.suggestionButtonEnabled?' '+"_xkf":''),n=[];if(this.props.onSuggestionsButtonMouseDown)n.push(h.createElement('div',{onMouseDown:this._onSuggestionButtonMouseDown,key:'suggestions',className:m,'data-testid':this.props.uniqueID+'_suggestions_button'},j._("Suggestions"),h.createElement('div',{className:"_ekn _xkm"})));if(this.props.onBrowseButtonMouseDown)n.push(h.createElement('div',{onMouseDown:this.props.onBrowseButtonMouseDown,key:'browse',className:"_4-97 _xkk",'data-testid':this.props.uniqueID+'_browse_button'},j._("Browse"),h.createElement('div',{className:"_ekn _xkl"})));return (h.createElement('div',{className:"_xkd"},n));},_onSuggestionButtonMouseDown:function(){if(!this.props.suggestionButtonEnabled)return;this.props.onSuggestionsButtonMouseDown();}});f.exports=l;},null);
__d('AdsSBTokenizerSuggestions.react',['AdsSBAreaClicked','AdsSBTokenizerConstants','AdsSBTokenizerPlusIcon.react','AdsSBTokenizerWhiteBox.react','Animation','ContextualLayer.react','ScrollableArea.react','React','ReactDOM','ReactLayeredComponentMixin','Style','AdInterfacesUiLogger','AdsSBTokenizerCheckBox.react','AdsFlexibleTargetingQETestConstant','TypeaheadMetricReporter','cx','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=u.NEW_SELECTION_STYLE,aa=o.PropTypes,ba=100,ca=30,da=i.TYPEAHEAD.HEIGHT,ea=i.WHITE_BOX.WIDTH,fa=o.createClass({displayName:'AdsSBTokenizerSuggestions',mixins:[q],propTypes:{hidden:aa.bool,entries:aa.array,onAddEntryAttempt:aa.func,selectedEntryIDs:aa.object,width:aa.number.isRequired,openToPath:aa.func,suggestionsDataSource:aa.object,uniqueID:aa.string.isRequired,reportedInterests:aa.object,addReportedInterests:aa.func,deleteReportedInterests:aa.func,cfSection:aa.string,showWhiteBox:aa.bool,metricReporter:aa.instanceOf(v)},getDefaultProps:function(){return {showWhiteBox:true};},getInitialState:function(){return {suggestions:[],highlightedEntry:null,sourceEntries:[],loading:false};},componentDidMount:function(){this.refreshSuggestions(false,[]);},refreshSuggestions:function(ha,ia){ia=ia||[];var ja=ia.map(function(ka){return ka.getTitle();});if(this.props.suggestionsDataSource){this.props.suggestionsDataSource.getSuggestions(ja,this.onDataFetched.bind(this,ha));this.props.metricReporter&&this.props.metricReporter.reportQueryBegin(ia.length.toString());this.setState({sourceEntries:ia,loading:true});this.setState({loading:true});}},onDataFetched:function(ha,ia){if(!this.isMounted())return;var ja=ia||[];if(ha){ja=this.state.suggestions.slice(0);var ka={};ja.forEach(function(la){ka[la.getUniqueID()]=true;});ia.forEach(function(la){if(!(la.getUniqueID() in ka)){ja.push(la);ka[la.getUniqueID()]=true;}});}if(ja.length>ca)ja=ja.slice(0,ca);this.props.metricReporter&&this.props.metricReporter.reportResults(ja.map(function(la){return la.getUniqueID();}),this.state.sourceEntries.length.toString());this.setState({suggestions:ja,loading:false});},render:function(){return o.createElement('div',{ref:'root'});},renderLayers:function(){var ha=this.state.suggestions.map(this._getSuggestionRow),ia="_50me"+(this.props.hidden?' '+"hidden_elem":''),ja=this.props.showWhiteBox&&this.state.highlightedEntry?this.props.width+ea:this.props.width,ka;if(this.props.showWhiteBox&&this.state.highlightedEntry)ka=o.createElement('div',{className:"_50mf"},o.createElement(k,{info:this.state.highlightedEntry,openToPath:this.props.openToPath?this.props.openToPath:x,type:i.ACTIVE_STATES.SUGGESTIONS,uniqueID:this.props.uniqueID,reportedInterests:this.props.reportedInterests,addReportedInterest:this.props.addReportedInterest,deleteReportedInterest:this.props.deleteReportedInterest}));if(ha.length===0&&!this.state.loading)ha=o.createElement('li',{className:"_50m9"},y._("No suggestions available. Please enter more interests to get suggestions."));var la=o.createElement('div',{onMouseLeave:this._onMouseLeave,onMouseDown:this._onMouseDown,className:ia,style:{width:ja}},o.createElement('div',{className:"_50ma",style:{width:this.props.width},'data-testid':this.props.uniqueID+'_suggestions_list'},o.createElement(n,{width:this.props.width,height:da},o.createElement('ul',{style:{minHeight:da},className:"_50mb"},ha)),ka));return {content:o.createElement(m,{alignment:'left',contextRef:(function(){return this.refs.root;}).bind(this),position:'below',shown:!this.props.hidden},la)};},_getSuggestionRow:function(ha){var ia=this.props.selectedEntryIDs||{};return (o.createElement(ga,{key:ha.getUniqueID(),entry:ha,onMouseEnter:this._onMouseEnterRow,onMouseLeave:this._onMouseLeave,highlighted:this.state.highlightedEntry===ha,onSelect:this._onEntrySelect,hidden:ha.getUniqueID() in ia}));},_onMouseEnterRow:function(ha){this.setState({highlightedEntry:ha});},_onEntrySelect:function(ha){if(this.props.metricReporter){this.props.metricReporter.reportSelect(ha.getUniqueID(),'interest',ha.getOrder(),true);this.props.metricReporter.sessionEnd();this.props.metricReporter.sessionStart();}s.log(this.props.uniqueID+'_select_from_suggestions',{fbid:ha.getUniqueID(),name:ha.getTitle(),type:'interest',position:ha.getOrder(),cf_section:this.props.cfSection});this.props.onAddEntryAttempt&&this.props.onAddEntryAttempt(ha);},_onMouseLeave:function(){this.setState({highlightedEntry:null});},_onMouseDown:function(){h.setAreaClicked(this.props.uniqueID,true);}}),ga=o.createClass({displayName:'AdsSBTokenizerSuggestionsRow',propTypes:{entry:aa.object,onMouseEnter:aa.func,highlighted:aa.bool,onSelect:aa.func,hidden:aa.bool,onMouseLeave:aa.func},componentDidUpdate:function(){r.set(p.findDOMNode(this),'opacity','');r.set(p.findDOMNode(this),'height','');},render:function(){var ha=this.props.entry,ia="_50mc"+(this.props.highlighted?' '+"_50md":'')+(this.props.hidden?' '+"hidden_elem":'')+(' '+"clearfix");return (o.createElement('li',{onMouseEnter:this._onMouseEnter,onClick:this._onClick,className:ia,'data-testid':this.props.uniqueID+'_suggestions_row'},o.createElement('div',{className:"_50m8"},ha.getTitle()),z?o.createElement(t,{hovered:this.props.highlighted}):o.createElement(j,{hovered:this.props.highlighted}),o.createElement('div',{className:"_5oe8"})));},_onMouseEnter:function(){this.props.onMouseEnter&&this.props.onMouseEnter(this.props.entry);},_onClick:function(){new l(p.findDOMNode(this)).to('opacity',0).to('height',0).blind().duration(ba).ondone((function(ha){this.props.onSelect&&this.props.onSelect(this.props.entry,ha);}).bind(this)).go();}});f.exports=fa;},null);
__d('AdsSBTokenizerValidationDialog.react',['AdsSBAreaClicked','LayerAutoFocus','LayerFadeOnHide','LayerHideOnEscape','React','ReactDOM','ReactLayeredComponentMixin','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogButton.react','cx','fbt','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=l.PropTypes,w=l.createClass({displayName:'AdsSBTokenizerValidationDialog',propTypes:{setEntries:v.func,uniqueID:v.string.isRequired},mixins:[n],getInitialState:function(){return {dialogShown:false,invalidEntries:[],newEntries:[],currentEntries:[]};},componentWillMount:function(){this._onToggleThrottled=u((function(x){if(this.isMounted())this.setState({dialogShown:x});}).bind(this),500);},show:function(event){this._onToggle(true);},_onToggle:function(x){this._onToggleThrottled&&this._onToggleThrottled(x);},renderLayers:function(){var x=this.state.newEntries,y=this.state.invalidEntries,z=x.map(function(da){return da.getTitle();}).join(', '),aa=y.map(function(da){return da.getTitle();}).join(', '),ba=this._getAudienceBroadened(x,y),ca=this._getDialogText(z,aa,ba);return {dialog:l.createElement(o,{shown:this.state.dialogShown,behaviors:{LayerAutoFocus:i,LayerFadeOnHide:j,LayerHideOnEscape:k},onToggle:this._onToggle,width:445},l.createElement(p,null,l.createElement('div',null,ca)),l.createElement(q,null,l.createElement(r,{label:t._("Cancel"),action:'cancel',onMouseDown:this._onActionMouseDown}),l.createElement(r,{label:t._("Okay"),use:'confirm',action:'cancel',ref:'confirmButton',className:'autofocus',onMouseDown:this._onActionMouseDown,onClick:this._onConfirm})))};},render:function(){return (l.createElement('div',null));},componentDidUpdate:function(){n.componentDidUpdate.call(this);this.refs&&m.findDOMNode(this.refs.confirmButton).focus();},_onConfirm:function(){this._onActionMouseDown();this.setValidatedEntries({newEntries:this.state.newEntries,currentEntries:this.state.currentEntries,invalidEntries:this.state.invalidEntries});},setValidatedEntries:function(x){var y={},z=[];x.currentEntries.forEach(function(ba){y[ba.getUniqueID()]=ba;});x.newEntries.forEach(function(ba){y[ba.getUniqueID()]=ba;});x.invalidEntries.forEach(function(ba){y[ba.getUniqueID()]=null;});for(var aa in y)if(y[aa])z.push(y[aa]);this.props.setEntries&&this.props.setEntries(z);},_onActionMouseDown:function(){h.setAreaClicked(this.props.uniqueID,true);this._onToggle(false);},_getDialogText:function(x,y,z){var aa;if(z){aa=t._("Do you want to change your interest targeting to {new entry}, which is more general than {invalid entry}? This will broaden your audience.",[t.param('new entry',l.createElement('span',{className:"_3bhc"},x)),t.param('invalid entry',l.createElement('span',{className:"_3bhc"},y))]);}else aa=t._("Do you want to change your interest targeting to {new entry}, which is more specific than {invalid entry}? This will narrow your audience.",[t.param('new entry',l.createElement('span',{className:"_3bhc"},x)),t.param('invalid entry',l.createElement('span',{className:"_3bhc"},y))]);return aa;},_getAudienceBroadened:function(x,y){var z=0;x.forEach(function(ba){z+=ba.reach||0;});var aa=0;y.forEach(function(ba){aa+=ba.reach||0;});return z>aa;},setInfo:function(x){this.setState({newEntries:x.newEntries,invalidEntries:x.invalidEntries,currentEntries:x.currentEntries});}});f.exports=w;},null);
__d('AudienceInterestsSearchSource',['AbstractSearchSource','AdsCreateFlowQueryLimits','AdsSearchBrowseUtils','CurrentLocale','GraphAPI','SearchableEntry'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;'use strict';var p;n=babelHelpers.inherits(q,h);o=n&&n.prototype;function q(r){o.constructor.call(this);if(p){return p;}else{this.options=r||{};return this;}}q.prototype.processResult=function(r,s,t){var u=[],v=r.data||r,w=s.toLowerCase();for(var x=v,y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var aa;if(y){if(z>=x.length)break;aa=x[z++];}else{z=x.next();if(z.done)break;aa=z.value;}var ba=aa,ca=ba.id,da=ba.name,ea=new m({uniqueID:ca,title:da});ea.disambiguationCategory=ba.disambiguation_category;ea.name=ba.name;ea.reach=ba.audience_size;ea.matchArray=j.getMatchedIndexArray(w,da.toLowerCase());ea.path=ba.path;if(ba.path&&ba.path.length){ea.path=ba.path.slice();ea.path.pop();ea.isInHierarchy=true;}ea.description=ba.description;ea.topic=ba.topic;u.push(ea);if(u.length>i.TYPEAHEAD_LIMIT)break;}t(u,s);};q.prototype.searchImpl=function(r,s,t){if(!r){s([],r);return;}var u=l('2.4').search('audienceinterest').get({q:r,locale:k.get(),whitelisted_only:this.options.whitelistedInterestsOnly});u.done((function(v){return this.processResult(v.data,r,s);}).bind(this),function(v){return false;});};q.getInstance=function(r){if(!p)p=new q(r);return p;};f.exports=q;},null);
__d("XAdPreferencesReportController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ads\/preferences\/report\/",{fbid:{type:"Int"},action:{type:"String",required:true},name:{type:"String"}});},null,{});
__d('AdsSearchBrowseInterests.react',['AdInterfacesUiLogger','AdsGraphAPI','AdsInterestsBrowseDataSource','AdsInterestsSearchSource','AdsInterestsSuggestionsDataSource','AdsInterestsValidationDataSource','AdsPreferencesConstants','AdsSBAreaClicked','AdsSBTokenizerConstants','AdsSBTokenizerExpandableListOld.react','AdsSBTokenizerModeButtons.react','AdsSBTokenizerSuggestions.react','AdsSBTokenizerValidationDialog.react','AdsSBTypeahead.react','AdsSearchBrowseTokenizerList.react','AsyncRequest','AudienceInterestsSearchSource','AudienceInterestsSuggestionsDataSource','AudienceInterestsValidationDataSource','CurrentLocale','React','ReactDOM','SearchableEntry','TypeaheadMetricReporter','AdsSB2TypeaheadEntriesView.react','XAdPreferencesReportController','AdsFlexibleTargetingQETestConstant','cx','fbt','getElementPosition','getUnboundedScrollPosition','joinClasses','StrSet'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){'use strict';if(c.__markCompiled)c.__markCompiled();var oa=ha.NEW_SELECTION_STYLE,pa=ba.PropTypes,qa='interests',ra={ViewRenderer:fa,useLayer:true};function sa(xa,ya){return ya.getUniqueID()===xa;}var ta=p.ACTIVE_STATES,ua=430,va=p.TOKENIZER_TYPES.INTERESTS,wa=ba.createClass({displayName:'AdsSearchBrowseInterests',propTypes:{accountID:pa.string,className:pa.string,cfSection:pa.string,dao:pa.object,deltaObjectID:pa.string,entries:pa.array,hideArrow:pa.bool,hideBrowseButton:pa.bool,hideSuggestions:pa.bool,hideTokenizerList:pa.bool,hideValidationDialog:pa.bool,interests:pa.array,listWidth:pa.number,onChange:pa.func,destinationID:pa.string,objective:pa.any,onUpdateInterests:pa.func,onUpdateInterestsAdsPrefs:pa.func,placeholder:pa.string,retrievePrefillSuggestions:pa.bool,showAnimation:pa.bool,showReach:pa.bool,showSuggestionWhiteBox:pa.bool,showWhiteBox:pa.bool,whitelistedInterestsOnly:pa.bool,useAudienceInterests:pa.bool},getDefaultProps:function(){return {interests:[],showAnimation:true,showReach:true,showSuggestionWhiteBox:true,showWhiteBox:true,retrievePrefillSuggestions:true,useAudienceInterests:false};},getInitialState:function(){return {entries:[],activeState:this._getDefaultActiveState(),newEntriesSet:{},reportedInterests:{}};},componentDidMount:function(){o.init();o.subscribe(va,this._onClickOutsideComponent);this._updateFromInterests({},this.props);this._fetchReportedInterests();if(this._showPrefillSuggestions(this.props.interests))this._prefillSuggestedInterests();},componentDidUpdate:function(){if(!this._shouldShowSuggestions()&&this.state.activeState===ta.SUGGESTIONS)this._setActiveState(ta.BROWSE);if(this.state.activeState!==ta.BROWSE)this.refs.expandableList.resetList();},componentWillReceiveProps:function(xa){if(xa.entries){this.setState({entries:xa.entries});}else if(xa.interests)this._updateFromInterests(this.props,xa);},componentWillMount:function(){var xa={event_name:'ads_targeting',event_specific_data:{context:va+'_typeahead',ad_account_id:this.props.accountID}};this._searchMetricReporter=new ea(xa);var ya={event_name:'ads_targeting',event_specific_data:{context:va+'_suggestion',ad_account_id:this.props.accountID}};this._suggestionMetricReporter=new ea(ya);},componentWillUnmount:function(){delete this._searchMetricReporter;delete this._suggestionMetricReporter;},_updateFromInterests:function(xa,ya){if(!ya.interests)return;var za=ya.interests,ab=xa.interests||[],bb=this._getInterestFBIDs(za),cb=this._getInterestFBIDs(ab),db=bb.sort().slice().join(',');if(cb.sort().slice().join(',')===db)return;this.setEntriesFromInterestsWithFBIDs(za);},_fetchReportedInterests:function(){var xa=ga.getURIBuilder().setString('action','get').getURI();new w(xa).setHandler((function(ya){if(!this.isMounted())return;var za=ya.payload.interests||{};this.setState({reportedInterests:za});}).bind(this)).send();},_showPrefillSuggestions:function(xa){if(!this.props.retrievePrefillSuggestions||xa&&xa.length>0)return false;return true;},_prefillSuggestedInterests:function(){var xa=i.getWithGeneralMigration().search('adrelatedinterests').get({object_id:this.props.destinationID,locale:aa.get(),objective:this.props.objective,is_prefill:true});xa.done((function(ya){var za=ya.data.map(function(ab){var bb=new da({uniqueID:ab.id,title:ab.name});bb.name=ab.name;bb.path=ab.path;if(ab.path&&ab.path.length){bb.path=ab.path.slice();bb.path.pop();bb.isInHierarchy=true;}bb.reach=ab.audience_size;bb.description=ab.description;bb.loggingSuffix='related_prefill';return bb;});this._onMultiAddEntries(za);}).bind(this),function(ya){return false;});},_addReportedInterest:function(xa,ya){var za=ga.getURIBuilder().setString('name',ya).setString('action','add').setInt('fbid',xa).getURI();new w(za).send();var ab=this.state.reportedInterests;ab[xa]=xa;this.setState({reportedInterests:ab});},_deleteReportedInterest:function(xa){var ya=ga.getURIBuilder().setString('action','del').setInt('fbid',xa).getURI();new w(ya).send();var za=this.state.reportedInterests;delete za[xa];this.setState({reportedInterests:za});},_getSelectedEntryIDs:function(){var xa=this.state.entries||[],ya={};xa.forEach(function(za){ya[za.getUniqueID()]=true;});return ya;},render:function(){var xa=this.props.useAudienceInterests?x.getInstance({whitelistedInterestsOnly:this.props.whitelistedInterestsOnly}):k.getInstance(this.props.dao,{whitelistedInterestsOnly:this.props.whitelistedInterestsOnly}),ya=j.getInstance(this.props.dao,{fetchInterestGroups:this.props.whitelistedInterestsOnly}),za=this.props.useAudienceInterests?new z():m.getInstance(this.props.dao),ab=this.props.useAudienceInterests?new y():l.getInstance(this.props.dao),bb=this.state.activeState!==ta.NONE;if(this.isMounted()&&!this._width)this._width=ca.findDOMNode(this).offsetWidth;var cb=this._width||ua;ra.extraRendererProps={openToPath:this._openToPath,width:cb,uniqueID:va,showWhiteBox:this.props.showWhiteBox,reportedInterests:this.state.reportedInterests,addReportedInterest:this._addReportedInterest,deleteReportedInterest:this._deleteReportedInterest,showCheckIcon:oa};var db="_19yt"+(bb?' '+"_5u07":'')+(' '+"uiContextualLayerParent")+(this.state.activeState===ta.BROWSE?' '+"_eko":'')+(this.state.activeState===ta.SUGGESTIONS?' '+"_ekm":'')+(this.state.activeState===ta.SEARCH?' '+"_ekp":'');db=ma(db,this.props.className);var eb=this.props.hideBrowseButton?null:ba.createElement(r,{onSuggestionsButtonMouseDown:this._shouldHideSuggestions()?null:this._onSuggestionsButtonMouseDown,onBrowseButtonMouseDown:this._onBrowseButtonMouseDown,suggestionButtonEnabled:this._shouldShowSuggestions(),uniqueID:va});return (ba.createElement('div',null,ba.createElement(t,{ref:'validationDialog',setEntries:this._onEntriesChange,uniqueID:va}),ba.createElement('div',{onMouseOver:function(){return o.setAreaClicked(va,true);},onMouseLeave:function(){return o.setAreaClicked(va,false);},className:db},this.props.hideTokenizerList?ba.createElement('div',null):ba.createElement(v,{entries:this.state.entries,onRemoveEntry:this._onRemoveEntryAttempt,openToPath:this._openToPath,onMultiRemoveEntries:this._onMultiRemoveEntries,newEntriesSet:this.state.newEntriesSet,reportedInterests:this.state.reportedInterests,addReportedInterest:this._addReportedInterest,deleteReportedInterest:this._deleteReportedInterest,showAnimation:this.props.showAnimation,showWhiteBox:this.props.showWhiteBox,uniqueID:va,cfSection:this.props.cfSection,showReach:this.props.showReach}),ba.createElement('div',{onMouseDown:this._onClickInsideComponent},ba.createElement('div',{className:"_5g-g"},ba.createElement(u,{excludedEntries:this._getSelectedEntryIDs(),onSelectAttempt:this._onSearchAddEntryAttempt,searchSource:xa,validationSource:za,presenter:ra,onInputChange:this._onInputChange,onTypeaheadVisibilityChanged:this._onTypeaheadVisibilityChanged,onMultiAddEntries:this._onMultiAddEntries,onClick:this._showListComponent,ref:'typeahead',placeholder:this.props.placeholder?this.props.placeholder:ja._("Search interests"),size:this.props.size,metricReporter:this._searchMetricReporter}),!this.props.hideArrow?ba.createElement('div',{className:"_ekn _ekl"}):null,eb),ba.createElement(q,{dataSource:ya,onAddEntryAttempt:this._onAddEntryAttempt,onRemoveEntryAttempt:this._onRemoveEntryAttempt,openToPath:this._openToPath,hidden:this.state.activeState!==ta.BROWSE,hideWhiteBoxOnBlur:false,openPath:this.state.openPath,selectedEntryIDs:this._getSelectedEntryIDs(),reportedInterests:this.state.reportedInterests,addReportedInterest:this._addReportedInterest,deleteReportedInterest:this._deleteReportedInterest,width:cb,uniqueID:va,showWhiteBox:this.props.showWhiteBox,ref:'expandableList',cfSection:this.props.cfSection,showReach:this.props.showReach,deltaObjectID:this.props.deltaObjectID,targetingSpecField:qa}),ba.createElement(s,{dao:this.props.dao,entries:this.state.entries,onAddEntryAttempt:this._onAddEntryAttempt,openToPath:this._openToPath,hidden:this.state.activeState!==ta.SUGGESTIONS,selectedEntryIDs:this._getSelectedEntryIDs(),ref:'suggestionsComponent',width:cb,uniqueID:va,reportedInterests:this.state.reportedInterests,addReportedInterest:this._addReportedInterest,deleteReportedInterest:this._deleteReportedInterest,suggestionsDataSource:ab,cfSection:this.props.cfSection,showWhiteBox:this.props.showSuggestionWhiteBox,metricReporter:this._suggestionMetricReporter})))));},setEntriesFromInterests:function(xa){if(!xa||!xa.length)this._onEntriesChangeNoAPIUpdate([]);var ya=m.getInstance(this.props.dao);ya.getMetadata(xa,this._setEntriesFromInterestsCB,true);},_getInterestFBIDs:function(xa){return (xa||[]).filter(function(ya){return ya.type!==n.CATEGORY_FILTERS.DEMOGRAPHICS;}).map(function(ya){return ya.id;});},setEntriesFromInterestsWithFBIDsCallUpdate:function(xa){if(!xa||!xa.length)this._onEntriesChange([]);var ya=this._getInterestFBIDs(xa),za=m.getInstance(this.props.dao);za.getMetadataFromFBID(ya,this._setEntriesFromInterestsCBCallUpdate);},setEntriesFromInterestsWithFBIDs:function(xa){if(!xa||!xa.length)this._onEntriesChangeNoAPIUpdate([]);var ya=this._getInterestFBIDs(xa),za=m.getInstance(this.props.dao);za.getMetadataFromFBID(ya,this._setEntriesFromInterestsCB);},_setEntriesFromInterestsCB:function(xa){if(!this.isMounted())return;var ya=new na(this._getInterestFBIDs(this.props.interests)),za=new na(xa.map(function(ab){return ab.getUniqueID();}));if(!za.equals(ya))return;this._onEntriesChangeNoAPIUpdate(xa);this.refs.suggestionsComponent.refreshSuggestions(false,xa);},_setEntriesFromInterestsCBCallUpdate:function(xa){if(!this.isMounted())return;this._onEntriesChange(xa);this.refs.suggestionsComponent.refreshSuggestions(false,xa);},_setInterestsFromEntries:function(xa){var ya=xa.map(function(za){return {id:za.getUniqueID(),name:za.getTitle()};});this._setInterests(ya);this.props.onUpdateInterests&&this.props.onUpdateInterests(ya);if(this.props.onUpdateInterestsAdsPrefs)this.props.onUpdateInterestsAdsPrefs(xa.map(function(za){return {id:za.getUniqueID(),name:za.getTitle(),topic:za.topic};}));this.props.onChange&&this.props.onChange(xa);},_onSearchAddEntryAttempt:function(xa){h.log(va+'_select_from_typeahead',{fbid:xa.getUniqueID(),name:xa.getTitle(),type:'interests',position:xa.order||xa.getOrder(),cf_section:this.props.cfSection});this._onAddEntryAttempt(xa);if(!xa.numLeafCategories)this._setActiveState(this._getDefaultActiveState());},_onAddEntryAttempt:function(xa){this._validateAndAddEntries([xa]);},_onRemoveEntryAttempt:function(xa){var ya=xa.getUniqueID(),za=this.state.entries.slice();za.some((function(ab,bb){if(sa(ya,ab)){za.splice(bb,1);this._onEntriesChange(za);return true;}return false;}).bind(this));},_onMultiAddEntries:function(xa){this._validateAndAddEntries(xa);},_onMultiRemoveEntries:function(xa){var ya=this.state.entries.slice(0);xa.forEach(function(za){if(ya.some(sa.bind(null,za.getUniqueID())))ya.splice(ya.indexOf(za),1);});this._onEntriesChange(ya);},_validateAndAddEntries:function(xa){var ya=this._getSelectedEntryIDs();xa=xa.filter(function(ab){return !(ab.getUniqueID() in ya);});var za=this._validateEntries(xa);if(za.length){if(this.props.hideValidationDialog){this.refs.validationDialog.setValidatedEntries({newEntries:xa,currentEntries:this.state.entries,invalidEntries:za});}else{this.refs.validationDialog.setInfo({newEntries:xa,currentEntries:this.state.entries,invalidEntries:za});this.refs.validationDialog.show();}}else this._onEntriesChange(this.state.entries.concat(xa));},_validateEntries:function(xa){var ya=this.state.entries.slice(),za=ya.concat(xa),ab={},bb={};za.forEach(function(eb){if(!eb.isInHierarchy)return;ab[eb.getTitle()]=eb;});za.forEach(function(eb){if(!eb.isInHierarchy)return;var fb=eb.path||[];for(var gb=0;gb<fb.length;gb++){var hb=ab[fb[gb]];if(fb[gb] in ab&&hb!==eb){bb[eb.getUniqueID()]=eb;bb[hb.getUniqueID()]=hb;}}});xa.forEach(function(eb){bb[eb.getUniqueID()]=null;});var cb=[];for(var db in bb)if(bb[db])cb.push(bb[db]);return cb;},_openToPath:function(xa){this._logActiveStateChange(this.state.activeState,ta.BROWSE);this.setState({openPath:xa,activeState:ta.BROWSE});},_onEntriesChange:function(xa){var ya={};this._setInterestsFromEntries(xa);this.refs.suggestionsComponent.refreshSuggestions(this.state.activeState===ta.SUGGESTIONS,xa);ya.entries=xa;ya.newEntriesSet=this._getNewEntries(this.state.entries,xa);this._logActiveStateChange(this.state.activeState,ya.activeState);this.setState(ya);},_onEntriesChangeNoAPIUpdate:function(xa){var ya={};this.refs.suggestionsComponent.refreshSuggestions(this.state.activeState===ta.SUGGESTIONS,xa);ya.entries=xa;ya.newEntriesSet=this._getNewEntries(this.state.entries,xa);this._logActiveStateChange(this.state.activeState,ya.activeState);this.setState(ya);},_getNewEntries:function(xa,ya){var za={};ya.forEach(function(ab){za[ab.getUniqueID()]=ab;});xa.forEach(function(ab){za[ab.getUniqueID()]=undefined;});return za;},_onClickOutsideComponent:function(){this.refs.typeahead.clearTypeahead();this._setActiveState(this._getDefaultActiveState());},_onBrowseButtonMouseDown:function(){var xa=this.state.activeState===ta.BROWSE?this._getDefaultActiveState():ta.BROWSE;this.refs.typeahead.clearTypeahead();this._setActiveState(xa);},_onSuggestionsButtonMouseDown:function(){var xa=this.state.activeState===ta.SUGGESTIONS?this._getDefaultActiveState():ta.SUGGESTIONS;this.refs.typeahead.clearTypeahead();this._setActiveState(xa);},_onTypeaheadVisibilityChanged:function(xa){if(xa){this._setActiveState(ta.SEARCH);}else this._setActiveState(ta.NONE);},_onClickInsideComponent:function(){o.setAreaClicked(va,true);setTimeout((function(){this.refs.typeahead.focusTypeahead();}).bind(this),100);},_showListComponent:function(){if(this._shouldShowSuggestions()){this._setActiveState(ta.SUGGESTIONS);}else this._setActiveState(ta.BROWSE);},_shouldShowSuggestions:function(){return !this._shouldHideSuggestions()&&this.state.entries.length>0;},_shouldHideSuggestions:function(){return this.props.hideSuggestions;},_centerComponentOnPage:function(){var xa=ca.findDOMNode(this.refs.typeahead),ya=ka(xa),za=la(window),ab=document.documentElement.clientHeight,bb=ya.y-ab/2+za.y;window.scrollTo(0,bb);},_setInterests:function(xa){this._interests=xa;},_setActiveState:function(xa){if(this._suggestionMetricReporter){if(this.state.activeState!==ta.SUGGESTIONS&&xa===ta.SUGGESTIONS)this._suggestionMetricReporter.sessionStart();if(this.state.activeState===ta.SUGGESTIONS&&xa!==ta.SUGGESTIONS)this._suggestionMetricReporter.sessionEnd();}this._logActiveStateChange(this.state.activeState,xa);this.setState({activeState:xa});},_logActiveStateChange:function(xa,ya){if(ya===null||ya===undefined||xa===ya)return;h.log(va+'_active_state_change',{active_state:ya,cf_section:this.props.cfSection});},_getDefaultActiveState:function(){return ta.NONE;},getInterests:function(){return this._interests;}});f.exports=wa;},null);
__d('AdsPreferencesAddedInterestNoticeGroup.react',['AdPreferencesDesktopStrings','React','ReactCSSTransitionGroup','XUINotice.react','XUINoticeGroup.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=i.PropTypes,p=i.createClass({displayName:'AdsPreferencesAddedInterestNoticeGroup',propTypes:{maxNoticeCount:o.number,noticeTimeout:o.number},getDefaultProps:function(){return {maxNoticeCount:3,noticeTimeout:6000};},getInitialState:function(){return {interests:[]};},_removeInterestFromNotice:function(q){var r=this.state.interests.filter(function(s){return q.id!=s.id;});this.setState({interests:r});},render:function(){var q=[];this.state.interests.forEach((function(r){var s=r.topic?n._("You added {interest_names} to your {category name} interests.",[n.param('interest_names',i.createElement('b',null,r.name)),n.param('category name',i.createElement('b',null,h[r.topic]))]):n._("You added {interest_names} to your interests.",[n.param('interest_names',i.createElement('b',null,r.name))]);q.push(i.createElement(k,{className:"_3-95 _1gx4",size:'small',use:'success',key:r.id,onDismiss:this._removeInterestFromNotice.bind(this,r)},s));}).bind(this));return (i.createElement(l,{className:"_3-8x"},i.createElement(j,{className:"_3y60",transitionEnterTimeout:300,transitionLeaveTimeout:300,transitionName:'adprefs-notice'},q)));},addInterestsToNoticeGroup:function(q){var r=this.state.interests;q.forEach((function(s){if(r.length===this.props.maxNoticeCount)r.shift();r.push(s);window.setTimeout((function(){this._removeInterestFromNotice(s);}).bind(this),this.props.noticeTimeout);}).bind(this));this.setState({interests:r});}});f.exports=p;},null);
__d('AdsPreferencesCategoryAddedDialog.react',['LayerFadeOnHide','React','ReactLayeredComponentMixin','XUIContextualDialog.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=i.createClass({displayName:'AdsPreferencesCategoryAddedDialog',mixins:[j],getInitialState:function(){return {dialogShown:false,interests:[]};},renderLayers:function(){return {contextualDialog:i.createElement(k,{behaviors:{LayerFadeOnHide:h},contextRef:(function(){return this.refs.componentWrapper;}).bind(this),shown:this.state.dialogShown,position:'above'},this._renderLayerContent())};},_renderLayerContent:function(){var o=this.state.interests,p=o.map(function(q){return q.name;});return (i.createElement('div',{className:"_2ph_"},m._("You've added {interest_names} to your ad preferences",[m.param('interest_names',i.createElement('b',null,p.join(', ')))])));},render:function(){return (i.createElement('div',{ref:'componentWrapper'},this.props.children));},setContentAndShow:function(o){if(this._showDialogTimeout)window.clearTimeout(this._showDialogTimeout);this.setState({interests:o,dialogShown:true});this._showDialogTimeout=window.setTimeout((function(){this._showDialogTimeout=null;this.setState({dialogShown:false});}).bind(this),4000);}});f.exports=n;},null);
__d('AdsPreferencesSuggestionsListItem.react',['Image.react','Layout.react','xuiglyph','React','XUIText.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=i.Column,p=i.FillColumn,q=k.PropTypes,r=k.createClass({displayName:'AdsPreferencesSuggestionsListItem',propTypes:{interest:q.object.isRequired,onSuggestionClick:q.func.isRequired,inMainList:q.bool.isRequired,isRemoved:q.bool.isRequired},getInitialState:function(){return {xHover:false,interestHover:false,enterTimeout:-1};},_xHover:function(){this.setState({xHover:!this.state.xHover});},_xOver:function(){if(!this.state.xHover)this.setState({xHover:true});},_interestHover:function(s){this.setState({interestHover:s});},_interestEnter:function(s,t,u){if(u){this._interestHover(true);return;}var v=setTimeout(this._interestEnter.bind(this,true,true,true),250);this.setState({enterTimeout:v});},_interestLeave:function(){this._interestHover(false);clearTimeout(this.state.enterTimeout);},_handleInterestClick:function(){this.props.onSuggestionClick(this.props.interest,!this.props.isRemoved,this.props.inMainList);},render:function(){var s=(this.state.interestHover?"_2imp":'')+(!this.state.interestHover?' '+"_2imq":'')+(' '+"_2imr"),t=k.createElement('span',{onMouseEnter:this._xHover,onMouseLeave:this._xHover,onMouseMove:this._xOver},k.createElement(h,{className:this.state.xHover?"hidden_elem":'',src:j({name:'cross',shade:'dark'})}),k.createElement(h,{className:!this.state.xHover?"hidden_elem":'',src:j({name:'cross',shade:'accent'})})),u=k.createElement('div',{className:s},k.createElement('a',{href:'#'},n._("Add"))),v=!this.props.isRemoved?t:u,w=k.createElement('div',{className:this.props.isRemoved?"hidden_elem":''},n._("Added"));return (k.createElement('li',{className:"_2imu",onMouseEnter:this._interestEnter,onMouseLeave:this._interestLeave},k.createElement(i,null,k.createElement(p,null,k.createElement(l,{size:'small',weight:'bold','data-fbid':this.props.interest.id},this.props.interest.name)),k.createElement(o,{className:'mlm'},k.createElement('div',{onClick:this._handleInterestClick,className:"_2imw"},v),k.createElement('div',{className:"_5tnl"},w)))));}});f.exports=r;},null);
__d('AdsPreferencesSuggestionsList.react',['AdsPreferencesSuggestionsListItem.react','List.react','React','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'AdsPreferencesSuggestionsList',propTypes:{adID:l.number,entrypoint:l.string,interestListFBIDs:l.object.isRequired,maxSuggestionsToShow:l.number.isRequired,onSuggestionClick:l.func.isRequired,removedInterests:l.object.isRequired,suggestions:l.array.isRequired},getInitialState:function(){return {};},render:function(){var n=this.props.suggestions;if(!n||n.length===0)return null;n=n.slice(0,this.props.maxSuggestionsToShow);var o=this.props.interestListFBIDs,p=n.map((function(q){var r=o[q.id]&&!this.props.removedInterests[q.id];return (j.createElement(h,{interest:q,isRemoved:!r,inMainList:!!o[q.id],key:q.id,onSuggestionClick:this.props.onSuggestionClick}));}).bind(this));return (j.createElement(i,{className:"_589n",edgepadding:true},p));}});f.exports=m;},null);
__d('AdsPreferencesCategoryInfoDialog.react',['AdPreferencesDesktopStrings','AdsPreferencesInterestListItem.react','AdsPreferencesSuggestionsList.react','LayerFadeOnHide','LayerHideOnEscape','List.react','React','ReactLayeredComponentMixin','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=n.PropTypes,u=5,v=n.createClass({displayName:'AdsPreferencesCategoryInfoDialog',mixins:[o],propTypes:{adID:t.number,entrypoint:t.string,onInterestClick:t.func,onReportPrefClick:t.func,onSuggestionClick:t.func,removedInterests:t.object,selectedInterests:t.object},getInitialState:function(){return {dialogShown:false,isFixedTopPosition:false,interests:t.array,category:t.object};},_onToggle:function(w){if(!w)this._onDialogClose();setTimeout(this.setState.bind(this,{dialogShown:w},null),0);},_onFixedTopPositionChange:function(event){this.setState({isFixedTopPosition:event.target.checked});},renderLayers:function(){if(!this.state.dialogShown)return {};return {dialog:n.createElement(p,{shown:true,behaviors:{LayerFadeOnHide:k,LayerHideOnEscape:l},onToggle:this._onToggle,fixedTopPosition:this.state.isFixedTopPosition?100:null,width:600},n.createElement(r,null,n.createElement('span',null,h.about_this_ads_preference)),n.createElement(q,{useCustomPadding:true,className:"_2pi1"},this._getCategoryList(),n.createElement('div',{className:"_2pif _2piq"},this.state.category.description),n.createElement('div',null,n.createElement(j,{adID:this.props.adID,entrypoint:this.props.entrypoint,interestListFBIDs:this.props.selectedInterests,maxSuggestionsToShow:u,onSuggestionClick:this.props.onSuggestionClick,removedInterests:this.props.removedInterests,suggestions:this.state.interests}))))};},_getCategoryList:function(){var w=this.state.category,x=!!this.props.removedInterests[w.id];return (n.createElement(m,{className:"_589n",edgepadding:true},n.createElement(i,{adID:this.props.adID,entrypoint:this.props.entrypoint,interest:w,isListItem:false,key:w.id,onInterestClick:this.props.onInterestClick,removed:x})));},_onDialogClose:function(){this.setState({dialogShown:false});},showDialog:function(w,x){this.setState({dialogShown:true,interests:w,category:x});},render:function(){return n.createElement('div',null);}});f.exports=v;},null);
__d('BUIFormRadioList.react',['React','XUIRadioList.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=c('XUIRadioList.react').Item,m=h.createClass({displayName:'BUIFormRadioList',propTypes:babelHelpers._extends({},i.propTypes),render:function(){return (h.createElement(i,babelHelpers._extends({},this.props,{className:k(this.props.className,"_8mz")}),this._renderChildren()));},_renderChildren:function(){return h.Children.map(this.props.children,function(n){return (h.cloneElement(n,{className:k(n.props.className,n.props.disabled?"_5w20":'')}));});}});m.Item=l;f.exports=m;},null);
__d("XAdsPreferencesReportInterestController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ads\/preferences\/write\/interest_reports\/",{pref_id:{type:"Int",required:true},name:{type:"String",required:true},reason:{type:"String",required:true},comments:{type:"String"}});},null,{});
__d('AdsPreferencesReportPreferenceDialog.react',['AsyncRequest','BUIForm.react','BUIFormRadioList.react','LayerFadeOnHide','React','ReactLayeredComponentMixin','TextInput.atlas','XAdsPreferencesReportInterestController','XUIButton.react','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';if(c.__markCompiled)c.__markCompiled();var u=c('BUIForm.react').Element,v=c('BUIFormRadioList.react').Item,w=c('BUIForm.react').Section,x=l.PropTypes,y=l.createClass({displayName:'AdsPreferencesReportPreferenceDialog',mixins:[m],propTypes:{},getInitialState:function(){return {dialogShown:false,flagReason:"inappropriate",isFixedTopPosition:false,interest:x.object,textFieldVal:''};},_onToggle:function(z){if(!z)this._onDialogClose();},_onFixedTopPositionChange:function(event){this.setState({isFixedTopPosition:event.target.checked});},_onChangeFlagReason:function(z){this.setState({flagReason:z});},_onTextFieldChange:function(z){this.setState({textFieldVal:z});},_onSubmit:function(event){var z=this.state.flagReason,aa=this.state.textFieldVal,ba=this.state.interest.name,ca=this.state.interest.id,da=o.getURIBuilder().setInt('pref_id',ca).setString('name',ba).setString('reason',z).setString('comments',aa).getURI(),ea=new h().setURI(da);ea.send();this.setState({dialogShown:false});},renderLayers:function(){if(!this.state.dialogShown)return {};return {dialog:l.createElement(q,{shown:true,behaviors:{LayerFadeOnHide:k},onToggle:this._onToggle,fixedTopPosition:this.state.isFixedTopPosition?100:null,width:600},l.createElement(s,null,'Report Preference: '+this.state.interest.name),l.createElement(r,{useCustomPadding:true,className:"_2pi1"},l.createElement(i,null,l.createElement(w,{title:'Why would you like to report this preference?'},l.createElement(u,{label:'Select a reason',labelAlign:'top'},l.createElement(j,{selectedValue:this.state.flagReason,onValueChange:this._onChangeFlagReason,className:"pas"},l.createElement(v,{value:'inappropriate'},'Inappropriate'),l.createElement(v,{value:'ambiguous'},'Requires Disambiguation (e.g., does "Mercury" refer to the planet or the element?)'),l.createElement(v,{value:'misspelled'},'Misspelled'),l.createElement(v,{value:'misclassified'},'Misclassified'),l.createElement(v,{value:'other'},'Other'))),l.createElement(u,{label:'Additional Information'},l.createElement('div',{style:{width:'320px'}},l.createElement(n,{onChange:this._onTextFieldChange,placeholder:'Additional info',value:this.state.textFieldVal}))),l.createElement(u,{label:''},l.createElement(p,{onClick:this._onSubmit,label:'Submit',use:'confirm'}))))))};},_onDialogClose:function(){this.setState({dialogShown:false});},showDialog:function(z){this.setState({dialogShown:true,interest:z});},render:function(){return l.createElement('div',null);}});f.exports=y;},null);
__d('AdsPreferencesList',['AdsPreferencesCategoryInfoDialog.react','AdPreferencesDesktopStrings','AdsPreferencesInterestListItem.react','AdsPreferencesReportPreferenceDialog.react','AsyncRequest','List.react','Link.react','React','ReactDOM','ReactLayeredComponentMixin','XAdPreferencesNUXController','XUIContextualDialog.react','XUIContextualDialogTitle.react','XUIContextualDialogBody.react','XUIContextualDialogFooter.react','XUIDialogCloseButton.react','XUIGrayText.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=o.PropTypes,aa=30,ba=10,ca="Other",da=o.createClass({displayName:'AdsPreferencesList',mixins:[q],propTypes:{adID:z.number,entrypoint:z.string,entries:z.array,interestRankingQEState:z.object,onRemoveInterest:z.func,onUndoRemoveInterest:z.func,onSuggestionClick:z.func,permitInternalReportPreference:z.bool.isRequired,removedInterests:z.object.isRequired,selectedInterests:z.object.isRequired,showBelowMinInterestsNUX:z.bool,showFirstRemovalNUX:z.bool,setEntriesFromInterestsWithFBIDs:z.func.isRequired},getInitialState:function(){var ea=Math.floor(Math.random()*5)+20;return {listExpandState:{},page:1,shownTopics:{},showFirstRemovalNUX:this.props.showFirstRemovalNUX,showBelowMinInterestsNUX:this.props.showBelowMinInterestsNUX?ea:0,showDialog:false,nodeRef:z.func};},render:function(){if(!this.props.entries||!this.props.entries.length)return o.createElement('div',null);var ea=this.props.interestRankingQEState&&this.props.interestRankingQEState.useSeeMoreExpansion,fa={},ga=this.state.listExpandState;this.props.entries.forEach(function(ka){var la=i[ka.topic]?i[ka.topic]:i[ca];if(!fa[la])fa[la]=[];if(!ga[la])ga[la]=1;fa[la].push(ka);});var ha=[],ia=Object.keys(fa),ja=ia.sort(function(ka,la){return ka>la?1:-1;});ja.forEach((function(ka){var la=0;fa[ka].forEach((function(ra){if(this.props.removedInterests[ra.id])la+=1;}).bind(this));var ma=this.state.shownTopics[ka]?o.createElement('div',{className:"_443y"}):o.createElement('div',{className:"_443z"});ha.push(o.createElement('li',{className:"_2pph _443-",key:ka,onClick:this._onTopicHeaderClick.bind(this,ka)},o.createElement('div',{className:"clearfix"},ma,o.createElement(x,{shade:'medium',className:"_443_"},ka),o.createElement('span',{className:"_2yxz"},fa[ka].length-la))));if(!this.state.shownTopics[ka])return;var na=this.props.interestRankingQEState&&!this.props.interestRankingQEState.useAlphabetSort?fa[ka]:fa[ka].sort(function(ra,sa){return ra.name.toLowerCase()>sa.name.toLowerCase()?1:-1;});if(fa[ka].length<=ba)ga[ka]=0;var oa=ea&&ga[ka]?na.slice(0,ga[ka]*ba):na,pa=oa.map((function(ra){var sa=!!this.props.removedInterests[ra.id];return (o.createElement(j,{adID:this.props.adID,entrypoint:this.props.entrypoint,interest:ra,isListItem:true,key:ra.id,onInterestClick:this._onInterestClick,removed:sa,setDialog:this._onCategoryNameClick,setReportDialog:this.props.permitInternalReportPreference?this._onReportPrefClick:null}));}).bind(this));ha.push(pa);if(ea&&ga[ka]&&ga[ka]*ba<fa[ka].length){var qa=this.seeMoreListItem(ka);ha.push(qa);}}).bind(this));if(ga!==this.state.listExpandState)this.setState({listExpandState:ga});return (o.createElement('div',null,o.createElement(m,{className:"_2ppi",edgepadding:true},ha),o.createElement(h,{adID:this.props.adID,entrypoint:this.props.entrypoint,onInterestClick:this._onInterestClick,onSuggestionClick:this.props.onSuggestionClick,removedInterests:this.props.removedInterests,selectedInterests:this.props.selectedInterests,ref:'categoryInfoDialog'}),o.createElement(k,{ref:'reportPrefDialog'})));},renderLayers:function(){if(!this.state.showDialog)return null;var ea,fa=null;if(this.state.showFirstRemovalNUX){ea=i.remove_interest_nux_body;}else{ea=i.below_min_interests_nux_body;fa=o.createElement(n,{href:'/help/247395082112892'},i.learn_more,'.');}return {contextualDialog:o.createElement(s,{alignment:'right',context:p.findDOMNode(this.state.nodeRef),focusContextOnHide:false,position:'below',shown:this.state.showDialog,width:s.WIDTH.NORMAL},o.createElement(t,null,i.remove_interest_nux_title),o.createElement(u,null,ea,' ',fa),o.createElement(v,null,o.createElement(w,{use:'confirm',label:'Close',onClick:this._hideDialog})))};},seeMoreListItem:function(ea){return (o.createElement('li',{className:"_z0p",key:ea+'listitem',onClick:this._onSeeMoreLinkClick.bind(this,ea)},o.createElement('div',{className:"clearfix"},o.createElement(x,{shade:'medium',className:"_443_"},'See More'))));},_onSeeMoreLinkClick:function(ea){var fa=this.state.listExpandState;fa[ea]+=1;this.setState({listExpandState:fa});},_hideDialog:function(){this.setState({showFirstRemovalNUX:false});this.setState({showBelowMinInterestsNUX:0});this.setState({showDialog:false});},_setInterests:function(ea,fa){this.props.setEntriesFromInterestsWithFBIDs(fa);},_onCategoryNameClick:function(ea,fa){this.refs.categoryInfoDialog.showDialog(fa,ea);},_onReportPrefClick:function(ea){this.refs.reportPrefDialog.showDialog(ea);},_getNumEntriesToDisplay:function(){return this.state.page*aa;},_onInterestClick:function(ea,fa,ga){var ha=ea.id,ia=ea.type||'interest';if(fa){this.props.onUndoRemoveInterest&&this.props.onUndoRemoveInterest(ia,ha);}else{this.props.onRemoveInterest&&this.props.onRemoveInterest(ia,ha);var ja=this.props.entries.length-Object.keys(this.props.removedInterests).length;if(ga!=null&&(this.state.showFirstRemovalNUX||ja<this.state.showBelowMinInterestsNUX)){this.setState({nodeRef:ga});this.setState({showDialog:true});var ka=this.state.showFirstRemoval?'interest_nux_ts':'interest_removal_nux_ts',la=r.getURIBuilder().setString('type',ka).getURI();new l(la).send();}}},_onTopicHeaderClick:function(ea){var fa=this.state.shownTopics;fa[ea]=!fa[ea];this.setState({shownTopics:fa});},_addInterests:function(ea){var fa=(this.props.selectedInterests||[]).slice();fa=fa.concat(ea);this.props.setEntriesFromInterestsWithFBIDs(fa);}});f.exports=da;},null);
__d('AdsPreferencesUiLogger',['AsyncRequest'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i='/ads/preferences/log/';function j(k){new h(i).setData(k).send();}f.exports={log:function(k,l,m){var n={event:k,ad_id:l,entry_point:m};j(n);},logWithDataMap:function(k,l){l.event=k;j(l);}};},null);
__d('XUICarouselLinks.react',['DOM','DOMClone','React','ReactDOM','DOMContainer.react','cloneWithProps','csx','cx','isNode','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=j.PropTypes,s=j.createClass({displayName:'XUICarouselLinks',propTypes:{carousel:r.object.isRequired,template:function(t){var u=t.template;if(u&&!j.isValidElement(u)&&!p(u))return new Error('Expected a DOM node or ReactElement for template');},width:r.number,centered:r.bool},getDefaultProps:function(){return {template:j.createElement('li',{className:"_3jav"}),centered:true};},getInitialState:function(){return {disabled:false,itemCount:this.props.carousel.getItemCount(),index:this.props.carousel.state.currentIndex};},componentWillMount:function(){this._registerToCarousel(this.props.carousel);},willDestroyElement:function(){this._unregisterCarousel();},_unregisterCarousel:function(){this.props.carousel.unsubscribe(this.arbiterToken);},_registerToCarousel:function(t){this.arbiterToken=t.subscribe(['animation_start','item_count_updated'],(function(u,v){if(u==='animation_start'){this.setState({index:v});}else this.setState({itemCount:v});}).bind(this));},componentWillUpdate:function(t){if(this.props.carousel!==t.carousel){this._unregisterCarousel();this._registerToCarousel(t.carousel);}},onLinkClick:function(t){this.props.carousel.setIndex(t);},renderLinks:function(){var t=[],u=this.props.template,v=j.isValidElement(u);for(var w=0;w<this.state.itemCount;w++){var x="_3jaw"+(w===this.state.index?' '+"_3el7":'');if(v){t.push(m(u,{className:q(u.className,x),key:w,onClick:this.onLinkClick.bind(this,w)}));}else t.push(j.createElement('div',{key:w,onClick:this.onLinkClick.bind(this,w),className:x},j.createElement(l,null,i.deepClone(u))));}return t;},render:function(){var t=q(this.props.className,"_3jay"+(this.props.centered?' '+"_3jaz":'')),u;if(this.props.width)u={width:this.props.width};setTimeout((function(){if(this.isMounted()){var v=h.scry(k.findDOMNode(this),"._3jaw");v.forEach(function(w){var x=w.style.display;w.style.display='none';w.offsetHeight;w.style.display=x;});}}).bind(this));return (j.createElement('div',{style:u},j.createElement('div',{className:t},this.renderLinks())));}});f.exports=s;},null);
__d('AdsPreferencesRHCCarousel.react',['AdPreferencesDesktopStrings','AdsPreferencesUiLogger','Image.react','Link.react','React','URI','XUICard.react','XUICarousel.react','XUICarouselItem.react','XUICarouselLinks.react','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=l.PropTypes;g.framework='React';var u=l.createClass({displayName:'AdsPreferencesRHCCarousel',propTypes:{extraData:t.object.isRequired,adID:t.number,entrypoint:t.string},getInitialState:function(){return {autoplayDirection:'forward',stopAutoplayOnHover:true,animationDuration:200,autoplayInterval:8000,isFirstRender:true};},renderLinks:function(){if(this.refs.carousel)return l.createElement(q,{carousel:this.refs.carousel});},render:function(){if(this.state.isFirstRender)setTimeout((function(){this.setState({isFirstRender:false});}).bind(this),0);var v=this.props.extraData.carousel.carousel_desktop_title,w=this.props.extraData.carousel.carousel_autoplay_interval,x=this.props.extraData.carousel.carousel_animation_duration,y=this.props.extraData.carousel.carousel_initial_autoplay,z=this.props.extraData.carousel.carousel_stop_autoplay_on_hover,aa=[s('/images/marketing/education/Ad-Preferences-Desktop-carousel-slide1.png'),s('/images/marketing/education/Ad-Preferences-Desktop-carousel-slide2.png'),s('/images/marketing/education/Ad-Preferences-Desktop-carousel-slide3.png'),s('/images/marketing/education/Ad-Preferences-Desktop-carousel-slide4.png')],ba=0,ca=[];this.props.extraData.carousel.carousel_items.forEach((function(da){ca.push(this._getCarouselItems(aa[ba],da.carousel_desktop_header,da.carousel_desktop_text,da.carousel_permalink_uri));ba++;}).bind(this));return (l.createElement(n,{className:"_4ese mbm"},l.createElement('h2',{className:"_4w_7 mbs"},v),l.createElement(o,{initialindex:1,initialAutoplay:y,autoplayInterval:w,autoplayDirection:this.state.autoplayDirection,animationDuration:x,stopAutoplayOnHover:z,ref:'carousel'},ca[0],ca[1],ca[2],ca[3]),this.renderLinks()));},_getCarouselItems:function(v,w,x,y){return (l.createElement(p,null,l.createElement('div',{className:"_2piu _2pik _2pip _4esf"},l.createElement(j,{className:"_3-9d",src:v,alt:w,width:250,height:125}),l.createElement('h1',{className:"_4esg"},w),l.createElement('p',{className:"_3-8w _3-95"},x),l.createElement(k,{target:'_blank',href:new m(y),onClick:this._onClickLink},this.props.extraData.carousel.carousel_desktop_linktext))));},_onClickLink:function(){i.log(h.carousel_learn_more_link_logging,this.props.adID,this.props.entrypoint);}});f.exports=u;},null);
__d('AdsPreferencesSuggestionsDialog.react',['AdPreferencesDesktopStrings','AdsPreferencesSuggestionsList.react','LayerFadeOnHide','LayerHideOnEscape','Link.react','React','ReactLayeredComponentMixin','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=m.PropTypes,t=10,u=m.createClass({displayName:'AdsPreferencesSuggestionsDialog',mixins:[n],propTypes:{adID:s.number,entrypoint:s.string,onSuggestionClick:s.func,removedInterests:s.object,selectedInterests:s.object,suggestions:s.array},getInitialState:function(){return {dialogShown:false,isFixedTopPosition:false};},_onToggle:function(v){if(!v)this._onDialogClose();setTimeout(this.setState.bind(this,{dialogShown:v},null),0);},_onFixedTopPositionChange:function(event){this.setState({isFixedTopPosition:event.target.checked});},renderLayers:function(){if(!this.state.dialogShown)return {};return {dialog:m.createElement(o,{shown:true,behaviors:{LayerFadeOnHide:j,LayerHideOnEscape:k},onToggle:this._onToggle,fixedTopPosition:this.state.isFixedTopPosition?100:null,width:600},m.createElement(q,null,m.createElement('span',null,h.more_suggestion_dialog_title)),m.createElement(p,{useCustomPadding:true,className:"_2pi1"},m.createElement('div',{className:"_2pip"},h.more_suggestion_dialog_text),m.createElement('div',null,m.createElement(i,{adID:this.props.adID,entrypoint:this.props.entrypoint,interestListFBIDs:this.props.selectedInterests,maxSuggestionsToShow:t,onSuggestionClick:this.props.onSuggestionClick,removedInterests:this.props.removedInterests,suggestions:this.props.suggestions}))))};},_onDialogClose:function(){this.setState({dialogShown:false});},_onLinkClick:function(){this.setState({dialogShown:true});},render:function(){var v=this.props.suggestions;if(!v||!v.length)return null;return (m.createElement('div',null,m.createElement(l,{href:'#',className:"_2g_u",onClick:this._onLinkClick},h.more_sugggestions_button)));}});f.exports=u;},null);
__d('AdsPreferencesSuggestionsCard.react',['AdPreferencesDesktopStrings','AdsPreferencesSuggestionsDialog.react','AdsPreferencesSuggestionsList.react','React','XUICard.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=k.PropTypes,o=4,p=k.createClass({displayName:'AdsPreferencesSuggestionsCard',propTypes:{adID:n.number,entrypoint:n.string,onSuggestionClick:n.func,removedInterests:n.object,selectedInterests:n.object,suggestedInterests:n.array},getInitialState:function(){return {};},render:function(){var q=this.props.suggestedInterests||[];if(!q||!q.length)return null;return (k.createElement(l,{className:"_4w_6 clearfix mbm"},k.createElement('h2',{className:"_4w_7 mbs"},h.suggested_preferences_title),k.createElement('div',{className:"_5sc0"},k.createElement('div',{className:"_3zdp _2pi3"},h.suggestions_helplink),k.createElement(j,{className:"_146y",adID:this.props.adID,entrypoint:this.props.entrypoint,interestListFBIDs:this.props.selectedInterests,maxSuggestionsToShow:o,onSuggestionClick:this.props.onSuggestionClick,removedInterests:this.props.removedInterests,suggestions:this.props.suggestedInterests}),k.createElement(i,{adID:this.props.adID,entrypoint:this.props.entrypoint,onSuggestionClick:this.props.onSuggestionClick,removedInterests:this.props.removedInterests,selectedInterests:this.props.selectedInterests,suggestions:q}))));}});f.exports=p;},null);
__d('AdsPreferencesDesktopView',['AdPreferencesDesktopStrings','AdPreferencesTypeStrings','AdsPreferencesAddedInterestNoticeGroup.react','AdsPreferencesCategoryAddedDialog.react','AdsPreferencesConstants','AdsPreferencesList','AdsPreferencesRHCCarousel.react','AdsPreferencesSuggestionsCard.react','AdsPreferencesUiLogger','AdsSearchBrowseInterests.react','AsyncRequest','DOMContainer.react','Link.react','React','ReloadPage','XAdPreferencesInterestsWriteController','XUICard.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa=u.PropTypes,ba=l.CATEGORY_FILTERS,ca=u.createClass({displayName:'AdsPreferencesDesktopView',propTypes:{adID:aa.number,entrypoint:aa.string,dao:aa.object.isRequired,extraData:aa.object.isRequired,initialInterests:aa.array.isRequired,suggestedInterests:aa.array},getInitialState:function(){return {interests:this.props.initialInterests,removedInterests:{},filter:ba.NONE};},componentDidMount:function(){if(this.props.initialInterests)this.refs.interestsTokenizer.setEntriesFromInterestsWithFBIDsCallUpdate(this.props.initialInterests);},render:function(){var da=this.props.extraData&&this.props.extraData.partner_categories_opt_out_card?u.createElement(s,null,this.props.extraData.partner_categories_opt_out_card):null,ea=this.props.extraData&&this.props.extraData.about_facebook_ads_card?u.createElement(s,null,this.props.extraData&&this.props.extraData.about_facebook_ads_card):u.createElement('div',{onMouseDown:this._onClickCarousel},u.createElement(n,{extraData:this.props.extraData,adID:this.props.adID,entrypoint:this.props.entrypoint})),fa=this.props.extraData.intro_text,ga=z._("Your Ad Preferences"),ha=h.edit_ad_preferences_blurb,ia=z._("Learn more."),ja=z._("Add Preference");if(fa){ga=fa.header;ha=fa.blurb;ia=fa.link;ja=fa.typeahead;}var ka=this.props.extraData&&this.props.extraData.notice_group?u.createElement(j,{className:"_1gx4",maxNoticeCount:this.props.extraData.notice_group.count,noticeTimeout:this.props.extraData.notice_group.timeout,ref:'addedInterestNoticeGroup'}):null;return (u.createElement('div',{className:"clearfix"},u.createElement('div',{className:"_55l0"},u.createElement(x,{className:"_4w_6"},u.createElement('h2',{className:"_4w_7"},ga,u.createElement('div',{className:"_1gx4 _3zdp _2pid"},ha,' ',u.createElement(t,{href:'/about/ads'},ia)),ka),u.createElement('div',{className:"_4w_9"},u.createElement(k,{ref:'categoryAddedDialog'},u.createElement(q,{ref:'interestsTokenizer',dao:this.props.dao,hideSuggestions:true,hideTokenizerList:true,hideValidationDialog:true,onUpdateInterestsAdsPrefs:this._onUpdateInterests,width:600,whitelistedInterestsOnly:true,showWhiteBox:false,placeholder:ja}))),u.createElement(m,{adID:this.props.adID,entrypoint:this.props.entrypoint,entries:this.state.interests,interestRankingQEState:this.props.extraData.interest_ranking_state,onRemoveInterest:this._onRemoveInterest,onUndoRemoveInterest:this._onUndoRemoveInterest,onSuggestionClick:this._onSuggestionClick,removedInterests:this.state.removedInterests,selectedInterests:this._getInterestFBIDs(),showFirstRemovalNUX:this.props.extraData.nux_info.interest_nux_ts,showBelowMinInterestsNUX:this.props.extraData.nux_info.interest_removal_nux_ts,setEntriesFromInterestsWithFBIDs:this._setEntriesFromInterestsWithFBIDs,permitInternalReportPreference:this.props.extraData.show_employee_pref_report_gk}))),u.createElement('div',{className:"_55l1"},ea,u.createElement(o,{adID:this.props.adID,entrypoint:this.props.entrypoint,onSuggestionClick:this._onSuggestionClick,removedInterests:this.state.removedInterests,selectedInterests:this._getInterestFBIDs(),suggestedInterests:this.props.suggestedInterests}),da)));},_setEntriesFromInterestsWithFBIDs:function(da,ea){this._suppressDialog=ea;this.refs.interestsTokenizer.setEntriesFromInterestsWithFBIDsCallUpdate(da);},_removeListItem:function(da){var ea=this.state.interests.filter(function(fa){return da.id!=fa.id;});this.setState({interests:ea});},_getAddedInterestFBIDs:function(){var da={};this.props.initialInterests.map(function(fa){da[fa.id]=true;});var ea={};this.state.interests.forEach(function(fa){if(!da[fa.id])ea[fa.id]=true;});return ea;},_onUpdateInterests:function(da){var ea={};this.state.interests.forEach(function(ia){ea[ia.id]=true;});var fa=[];da.forEach(function(ia){if(!ea[ia.id])fa.push(ia);});if(!fa.length)return;var ga=fa.map(function(ia){return ia.id;}),ha=ga.filter((function(ia){return !this.state.removedInterests[ia];}).bind(this));this._sendEditPrefsRequest(i.interest,'add',ha);this.setState({interests:fa.concat(this.state.interests)});if(this.props.extraData.notice_group){this.refs.addedInterestNoticeGroup.addInterestsToNoticeGroup(fa);}else if(!this._suppressDialog)this.refs.categoryAddedDialog.setContentAndShow(fa);this._suppressDialog=false;},_onRemoveInterest:function(da,ea){var fa=this.state.removedInterests;fa[ea]=true;this._sendEditPrefsRequest(da,'del',[ea]);var ga=this.state.interests,ha=ga.map(function(ia){return String(ia.id);}).indexOf(String(ea));if(ga[ha].type==='interest')ga[ha].description=z._("This is a preference you added.");this.setState({interests:ga});this.setState({removedInterests:fa});},_onUndoRemoveInterest:function(da,ea){var fa=this.state.removedInterests;delete fa[ea];this._sendEditPrefsRequest(da,'add',[ea]);this.setState({removedInterests:fa});},_sendEditPrefsRequest:function(da,ea,fa){var ga=w.getURIBuilder().setInt('ad_id',this.props.adID).setString('entry_point',this.props.entrypoint).setEnum('action',ea).setEnum('type',da).setIntVector('fbids',fa).getURI();new r(ga).setErrorHandler(function(){v.now();}).send();},_onSuggestionClick:function(da,ea,fa){if(ea){var ga=[da.id];this._sendEditPrefsRequest('interest','del',ga);this._removeListItem(da);}else if(!ea&&fa){var ha=da.type||'interest';this._onUndoRemoveInterest(ha,da.id);}else{var ia=(this.state.interests||[]).slice();ia.push(da);this._setEntriesFromInterestsWithFBIDs(ia,true);}},_getInterestFBIDs:function(){var da={};this.state.interests.forEach(function(ea){da[ea.id]=true;});return da;},_onFilterChange:function(da){this.setState({filter:da.value});},_onClickCarousel:function(){p.log(h.carousel_card_logging,this.props.adID,this.props.entrypoint);}});f.exports=ca;},null);
__d('AdsPreferencesDesktop',['AdsDaoGraph','AdsPreferencesDesktopView','AdInterfacesUiLogger','CurrentLocale','GraphAPI','React','ReactDOM','WebApiApplication'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';if(c.__markCompiled)c.__markCompiled();var p='ads_preferences',q={init:function(r,s,t,u,v,w,x,y){o.init(s,t.toString());var z=h.primedForLocale(k.get());j.setAppName(p);l.setErrorHandler(function(aa){});n.render(m.createElement(i,{adID:w,entrypoint:x,dao:z,extraData:y,initialInterests:u,suggestedInterests:v}),document.getElementById(r));}};f.exports=q;},null);