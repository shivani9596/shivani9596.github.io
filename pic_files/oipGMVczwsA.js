/*!CK:809368570!*//*1442804321,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TvJrx"]); }

__d('ChatSearchSource',['requireWeak','AbstractSearchSource','AsyncRequest','CurrentUser','MercuryParticipantTypes','SearchableEntry','SearchSourceCallbackManager','ShortProfiles','TokenizeUtil','emptyFunction','isValidUniqueID'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s,t;'use strict';var u=null;h('OrderedFriendsList',function(w){u=w;});s=babelHelpers.inherits(v,i);t=s&&s.prototype;function v(w){t.constructor.call(this);this.$ChatSearchSource1=new n({parseFn:p.parse,matchFn:p.isQueryMatch,indexFn:w.indexFn});this.$ChatSearchSource2=w.queryRequests||[];this.$ChatSearchSource3=false;}v.prototype.bootstrapImpl=function(w){o.fetchAll().then((function(){this.$ChatSearchSource3=true;this.$ChatSearchSource4();w();}).bind(this));};v.prototype.searchImpl=function(w,x,y){var z=null,aa={},ba=y&&y.onQueryFinished,ca=y&&y.onQueryStarted;ca&&ca(w);var da=this.$ChatSearchSource1.search(w,(function(ga){if(!z){z=ga;z.forEach(function(ha){return aa[ha.getUniqueID()]=true;});}else ga.forEach(function(ha){var ia=ha.getUniqueID();if(!aa[ia]){z.push(ha);aa[ia]=true;}});x(z,w);if(w.length===1&&this.$ChatSearchSource3)ba&&ba(w);}).bind(this),y);if(!da||!this.$ChatSearchSource2||!this.$ChatSearchSource2.length||w.length===0){ba&&ba(w);return;}if(w.length===1){if(this.$ChatSearchSource3)ba&&ba(w);return;}var ea={value:w,existing_ids:z&&z.map(function(ga){return ga.getUniqueID();}).join(','),limit:y&&y.threadLimit},fa=this.$ChatSearchSource2.length;this.$ChatSearchSource2.forEach((function(ga){this.$ChatSearchSource5(ea,ga,(function(ha){this.$ChatSearchSource6(this.$ChatSearchSource7(this.$ChatSearchSource8(ha)).filter(function(ia){return !!ia;}),w);fa--;if(fa===0){this.$ChatSearchSource1.setQueryStringAsExhausted(w);ba&&ba(w);}}).bind(this));}).bind(this),this);};v.prototype.getAllEntriesMap=function(){return this.$ChatSearchSource1.getAllEntries();};v.prototype.$ChatSearchSource4=function(){var w=o.getCachedProfileIDs(),x=w.filter(function(z){var aa=o.getNow(z);return (z==k.getID()||aa.type===l.FRIEND);}),y=x.map(this.$ChatSearchSource9);if(y.length)this.$ChatSearchSource1.addLocalEntries(y);};v.prototype.$ChatSearchSource7=function(w){return w.map(this.$ChatSearchSource10,this);};v.prototype.$ChatSearchSource10=function(w,x){if(w.mercury_thread){if(!u)return null;return u.normalizeThreadEntry(w,x);}var y=w.text,z=w.uid;if(!y||!r(z))return null;return new m({uniqueID:z,title:y,order:u?u.getActiveRank(z):0,subtitle:w.subtext,type:w.render_type||w.type,photo:w.photo,uri:w.path,auxiliaryData:{isMessengerUser:w.is_messenger_user,alias:w.alias}});};v.prototype.$ChatSearchSource8=function(w){var x=w.getPayload();if(Array.isArray(x)){return x;}else if(x&&x.entries){return x.entries;}else return [];};v.prototype.$ChatSearchSource9=function(w){var x=o.getNow(w),y=w==k.getID()?l.FRIEND:x.type,z=[x.additionalName,x.alternateName].concat(x.searchTokens||[]).join(' ');return new m({uniqueID:w,title:x.name,order:u?u.getActiveRank(w):0,subtitle:x.additionalName,keywordString:z,type:y,photo:x.thumbSrc,uri:x.uri,auxiliaryData:{isMessengerUser:x.is_messenger_user,alias:x.alias}});};v.prototype.$ChatSearchSource5=function(w,x,y,z){new j(x.uri).setData(babelHelpers._extends({},w,x.data)).setMethod('GET').setReadOnly(true).setHandler(y).setErrorHandler(z||q).setAllowCrossPageTransition(true).send();};v.prototype.$ChatSearchSource6=function(w,x){if(w.length)this.$ChatSearchSource1.addQueryEntries(w,x);};v.prototype.addLocalEntries=function(w){this.$ChatSearchSource1.addLocalEntries(w);};v.prototype.refreshData=function(){o.fetchAll();h('AvailableList',function(w){return w.update();});};f.exports=v;},null);
__d('MessengerTypeaheadUtils',['immutable','MercuryConfig','MercuryTypeaheadConstants','React','ReactDOM','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=h.OrderedMap,o={sortEntries:function(p,q){var r=[],s=[],t=[],u=[],v=[];p.forEach(function(w){switch(w.getType()){case j.FRIEND_TYPE:r.push(w);break;case j.FB4C_TYPE:s.push(w);break;case j.THREAD_TYPE:t.push(w);break;case j.PAGE_TYPE:v.push(w);break;case j.NON_FRIEND_TYPE:u.push(w);break;}});if(o._shouldHoistPages(q))return v.concat(r,s,t,u);return r.concat(s,t,v,u);},sortEntriesWithoutPages:function(p){var q=[],r=[],s=[],t=[];p.forEach(function(u){switch(u.getType()){case j.FRIEND_TYPE:q.push(u);break;case j.FB4C_TYPE:r.push(u);break;case j.THREAD_TYPE:s.push(u);break;case j.NON_FRIEND_TYPE:t.push(u);break;}});return q.concat(r,s,t);},sortEntriesWithoutGroupsOrViewer:function(p,q){var r=[],s=[],t=[];p.forEach(function(u){if(u.getUniqueID()===q)return;switch(u.getType()){case j.FRIEND_TYPE:r.push(u);break;case j.FB4C_TYPE:s.push(u);break;case j.NON_FRIEND_TYPE:t.push(u);break;}});return r.concat(s,t);},buildListSections:function(p,q){if(!p.length)return n();var r=[],s=[],t=[],u=[],v=[],w=[];p.forEach(function(z){switch(z.getType()){case j.FRIEND_TYPE:s.push(z);break;case j.FB4C_TYPE:t.push(z);break;case j.THREAD_TYPE:u.push(z);break;case j.PAGE_TYPE:w.push(z);break;case j.NON_FRIEND_TYPE:v.push(z);break;}});var x=[m._("Businesses"),w],y=o._shouldHoistPages(q);if(y&&w.length)r.push(x);if(s.length)r.push([y?m._("Friends"):'',s]);if(t.length)r.push([m._("Co-workers"),t]);if(u.length)r.push([m._("Group Conversations"),u]);if(w.length&&!y)r.push(x);if(v.length)r.push([m._("More People"),v]);return n(r);},scrollEntryIntoView:function(p,q){var r=l.findDOMNode(q),s=q.getScrollTop(),t=p.offsetTop-s,u=r.offsetHeight-p.offsetHeight;if(t>=u){q.scrollToPosition(s+t-u);}else if(t<0)q.scrollToPosition(s+t);},_shouldHoistPages:function(p){return !!(i.WWWMessengerMoneyPennyGK&&p&&i.HoistAgentsKeywords&&i.HoistAgentsKeywords.indexOf(p.toLowerCase())!==-1);}};f.exports=o;},null);
__d('ShareDialogAudienceTypeahead.react',['Grid.react','React','XUITypeahead.react','cx','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=h.GridItem,o=i.PropTypes,p=i.createClass({displayName:'ShareDialogAudienceTypeahead',propTypes:{searchSource:o.object.isRequired,userId:o.string,prefix:o.string,onClear:o.func,onChange:o.func},getDefaultProps:function(){return {onClear:l,onChange:l};},getInitialState:function(){return {query:'',selectedEntry:null};},_onBlur:function(){if(!this.state.selectedEntry||this.state.selectedEntry.getTitle()!==this.state.query)this._clearSelection();},_clearSelection:function(){this.setState({query:'',selectedEntry:null});this.props.onClear();},render:function(){var q=this.props,r=q.className,s=babelHelpers.objectWithoutProperties(q,['className']),t=!!this.state.selectedEntry,u={};if(this.props.userId)u[this.props.userId]=true;var v=this.props.prefix?i.createElement('span',{className:"_2qx7"},this.props.prefix):i.createElement('noscript',null),w=this.props.prefix?"_2qx6":null;return (i.createElement(h,{className:w,cols:2},i.createElement(n,{key:'prefix',className:"_1ho1"},v),i.createElement(n,{key:'suffix',className:"_1xk6"},i.createElement(j,babelHelpers._extends({},s,{className:m(r,"_39y9"+(t?' '+"_39ya":'')),excludedEntries:u,onChange:this._onChange,onClear:this._onClear,onBlur:this._onBlur,onSelectAttempt:this._onSelect,queryString:this.state.query,searchSource:this.props.searchSource,focusedOnInit:true,showEntriesOnFocus:false,clearable:true,selectedEntry:this.state.selectedEntry,tallInput:true})))));},_onSelect:function(q){this.setState({query:q.getTitle(),selectedEntry:q});this.props.onChange([q.getUniqueID()]);},_onChange:function(event){var q=event.target.value;if(this.state.selectedEntry&&this.state.selectedEntry.getTitle()!==q){this.setState({query:q,selectedEntry:null});}else this.setState({query:q});},_onClear:function(){this.setState({query:'',selectedEntry:null});this.props.onClear();}});f.exports=p;},null);
__d('ShareDialogGroupAudience.react',['React','ShareDialogAudienceTypeahead.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'ShareDialogGroupAudience',propTypes:{searchSource:l.object.isRequired,onClear:l.func,onSelect:l.func},getInitialState:function(){return {query:'',selectedEntry:null};},render:function(){var n=k._("Group:");return (h.createElement(i,babelHelpers._extends({},this.props,{prefix:n,showPhoto:true,name:'audience_group',inputID:'audience_group',className:"_2n3i",placeholder:k._("Group Name")})));}});f.exports=m;},null);
__d('ShareDialogMessageAudience.react',['ChatSearchSource','Grid.react','MercuryTypeaheadConstants','MessengerTypeaheadUtils','React','ShareDialogTypeaheadView.react','XUITokenizer.react','XUITokenizerToken.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=i.GridItem,s=l.PropTypes,t=l.createClass({displayName:'ShareDialogMessageAudience',propTypes:{userId:s.string,onClear:s.func,onChange:s.func,messageTargets:s.array},componentWillMount:function(){this._searchSource=new h({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});},getInitialState:function(){return {entries:[]};},render:function(){var u=this._shouldBeDisabled();return (l.createElement(i,{className:"_2qx6",cols:2},l.createElement(r,{className:"_1ho1",key:'prefix'},l.createElement('span',{className:"_2qx7"},q._("To:"))),l.createElement(r,{className:"_1xk6",key:'suffix'},l.createElement(n,babelHelpers._extends({},this.props,{className:"_39y9"+(' '+"_42z0")+(u?' '+"_39ya":''),placeholder:q._("Names"),name:'audience_message',inputID:'audience_message',value:this.state.entries,focusedOnInit:true,selectOnTab:true,showEntriesOnFocus:false,entries:this.state.entries,searchSource:this._searchSource,onRemoveEntryAttempt:this._onRemoveEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,disabled:u,presenter:{ViewRenderer:m,TokenRenderer:o,useLayer:true,sortEntries:this._sortEntries}})))));},componentDidMount:function(){var u=this.props.messageTargets;if(u)for(var v=0;v<u.length;++v)if(u[v])this._onAddEntryAttempt(u[v]);},_sortEntries:function(u){if(this.state.entries.length)return k.sortEntriesWithoutGroupsOrViewer(u,this.props.userId);return k.sortEntriesWithoutPages(u);},_shouldBeDisabled:function(){var u=this.state.entries;return u.length===1&&u[0].getType()===j.THREAD_TYPE;},_onAddEntryAttempt:function(u){var v=u.getUniqueID(),w=this.state.entries,x=w.some(function(y){if(y.getUniqueID()===v)return true;});if(x)return;w.push(u);this.props.onChange(w.map(function(y){return y.getUniqueID();}));this.setState({entries:w});},_onRemoveEntryAttempt:function(u){var v=u.getUniqueID(),w=this.state.entries,x=w.some(function(y){if(y.getUniqueID()===v)return true;});if(x)w.splice(w.indexOf(u),1);this.props.onChange(w.map(function(y){return y.getUniqueID();}));if(w.length===0)this.props.onClear();this.setState({entries:w});}});f.exports=t;},null);
__d('ShareDialogPageAudience.react',['React','Image.react','LeftRight.react','ShareActorSelector.react','XUISelector.react','cx','emptyFunction','fbt','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=h.PropTypes,r=l.Option,s=h.createClass({displayName:'ShareDialogPageAudience',propTypes:{pagesSource:q.object.isRequired,onClear:q.func,onSelect:q.func},getInitialState:function(){var t=p(this.props.pagesSource)[0];return {selectedPageID:t.id,selectedActorID:t.id,onClear:n,onChange:n};},render:function(){if(!this.props.pagesSource)return h.createElement('span',null);var t=p(this.props.pagesSource).map(function(u){return (h.createElement(r,{key:u.id,value:u.id,icon:h.createElement(i,{src:u.pic,height:15,width:15})},u.name));});return (h.createElement('div',{className:"_15u8"},h.createElement(j,null,h.createElement(l,{className:"_15u9",name:'audience_page',inputID:'audience_page',maxheight:150,value:this.state.selectedPageID,defaultValue:this.state.selectedPageID,onChange:(function(u){this.setState({selectedPageID:u.value});this.props.onChange([{pageId:u.value,actorId:this.state.selectedActorID}]);}).bind(this)},t),h.createElement('span',null,h.createElement('strong',{className:"_15ua"},o._("Posting as"),' '),h.createElement(k,{name:'audience_page_identity',onChange:(function(u){this.setState({selectedActorID:u.value});this.props.onChange([{pageId:this.state.selectedPageID,actorId:u.value}]);}).bind(this),targetID:this.state.selectedPageID})))));}});f.exports=s;},null);
__d('ShareDialogPersonAudience.react',['React','ShareDialogAudienceTypeahead.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'ShareDialogPersonAudience',propTypes:{searchSource:l.object.isRequired,userId:l.string,onClear:l.func,onSelect:l.func},render:function(){var n=k._("Friend:");return (h.createElement(i,babelHelpers._extends({},this.props,{prefix:n,searchSource:this.props.searchSource,className:"_4heg",name:'friendTarget',inputID:'friendTarget',clearable:true,placeholder:k._("Friend's Name")})));}});f.exports=m;},null);