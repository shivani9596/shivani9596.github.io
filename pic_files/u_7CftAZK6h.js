/*!CK:658970079!*//*1440509910,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["i7QZL"]); }

__d('ComposerCitySharer',['Arbiter','ArbiterMixin','AsyncRequest','CSS','DOM','Event','Parent','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r={};p=babelHelpers.inherits(s,o(i));q=p&&p.prototype;function s(t){'use strict';q.constructor.call(this);this.root=t;}s.prototype.init=function(t,u,v,w,x){'use strict';this.cityLink=t;this.closeButton=u;this.input=v;this.disableShareInput=w;this._options=x;this.cityName=l.find(this.cityLink,'.cityName');this.data={};m.listen(this.closeButton,'click',(function(){this.clearCity();this.disableShareInput.value='true';}).bind(this));r[this.root]=this;this.inform('init',null,h.BEHAVIOR_PERSISTENT);};s.prototype.changeCity=function(t,u,v){'use strict';this.setCityId(t,u,v);this.toggleLocationSharing(t,u,v,false);};s.prototype.setCityId=function(t,u,v){'use strict';if(u){this.data={city_name:t,city_page_id:u,city_id:v};this.input.value=u;var w=t.lastIndexOf(',');if(w!=-1)t=t.substring(0,w);var x=t;l.setContent(this.cityName,x);k.addClass(this.root,'ComposerCitySharerCitySelected');k.conditionShow(this.closeButton,!this._placeSelected);this.inform('change',this.data,h.BEHAVIOR_PERSISTENT);}};s.prototype.toggleLocationSharing=function(t,u,v,w){'use strict';if(u)new j().setURI('/ajax/places/toggle_location_sharing').setData({city_id:v,city_page_id:u,city_name:t,is_default:w,session_id:this._options.session_id}).send();};s.prototype.setDefaultCity=function(t,u,v){'use strict';this._defaultCityData=[t,u,v];};s.prototype.useDefaultCity=function(){'use strict';if(this._defaultCityData){var t=this._defaultCityData[0],u=this._defaultCityData[1],v=this._defaultCityData[2];this.setCityId(t,u,v);this.toggleLocationSharing(t,u,v,true);}};s.prototype.addPlace=function(t){'use strict';if(t.city_id){this.changeCity(t.city_name,t.city_page_id,t.city_id);}else this.clearCity();this._placeSelected=true;k.addClass(this.cityLink,'placeIconSelected');k.hide(this.closeButton);};s.prototype.clearPlace=function(t){'use strict';this._placeSelected=false;k.removeClass(this.cityLink,'placeIconSelected');k.conditionShow(this.closeButton,this.getValue());};s.prototype.clearCity=function(){'use strict';this.data={};this.input.value='';l.setContent(this.cityName,'');k.removeClass(this.root,'ComposerCitySharerCitySelected');k.hide(this.closeButton);this.inform('change',null,h.BEHAVIOR_PERSISTENT);};s.prototype.getIcon=function(){'use strict';return this.root;};s.prototype.getValue=function(){'use strict';return this.input.value;};s.getInstance=function(t){'use strict';var u=n.byClass(t,'ComposerCitySharer');return u&&r[u];};f.exports=s;},null);
__d('ContextualBlind',['Event','Animation','Arbiter','DOM','Rect','Vector','$','cx','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=0,r=1,s=.8,t=500;u.prototype.$ContextualBlind1=function(){'use strict';this.$ContextualBlind2&&j.unsubscribe(this.$ContextualBlind2);this.$ContextualBlind2=null;this.$ContextualBlind3=[];this.$ContextualBlind4&&this.$ContextualBlind4.remove();this.$ContextualBlind4=null;this.$ContextualBlind5&&k.remove(this.$ContextualBlind5);this.$ContextualBlind6=false;};u.prototype.show=function(v,w,x,y,z,aa,ba,ca){'use strict';if(ba==null)ba=s;ca=ca||q;this.hide();var da=ca===q?"_2xgb":"_2xgc";for(var ea=0;ea<4;ea++)this.$ContextualBlind3.push(k.create('div',{className:da,style:'opacity:'+ba}));k.appendContent(document.body,this.$ContextualBlind3);if(aa!==false){da=ca===q?"_2xgd":"_2xge";this.$ContextualBlind5=k.create('div',{className:da});k.appendContent(document.body,this.$ContextualBlind5);}var fa=p(this.updatePosition,this,v,w,x,y,z);fa();this.$ContextualBlind2=j.subscribe('reflow',fa);this.$ContextualBlind4=h.listen(window,'resize',fa);this.$ContextualBlind6=true;};u.prototype.fadeIn=function(v,w,x,y,z,aa,ba,ca){'use strict';ca=ca||t;if(ba==null)ba=s;this.show(v,w,x,y,z,aa,ba,q);if(this.$ContextualBlind6)return;for(var da=0;da<this.$ContextualBlind3.length;da++){var ea=this.$ContextualBlind3[da];new i(ea).duration(ca).from('opacity',0).to('opacity',ba).go();}};u.prototype.hide=function(){'use strict';this.$ContextualBlind3&&this.$ContextualBlind3.forEach(k.remove);this.$ContextualBlind1();};u.prototype.fadeOut=function(){'use strict';for(var v=0;v<this.$ContextualBlind3.length;v++){var w=this.$ContextualBlind3[v];new i(w).duration(t).from('opacity',s).to('opacity',0).ondone(k.remove.bind(null,w)).go();}this.$ContextualBlind1();};u.prototype.$ContextualBlind7=function(v,w){'use strict';w.getPositionVector().setElementPosition(v);w.getDimensionVector().setElementDimensions(v);};u.prototype.updatePosition=function(v,w,x,y,z){'use strict';var aa=m.getDocumentDimensions().y,ba=l.getElementBounds(n(v));ba=new l(ba.t-(w||0),ba.r+(x||0),ba.b+(y||0),ba.l-(z||0),ba.domain);var ca=document,da=ca&&ca.documentElement&&ca.documentElement.scrollWidth||ca&&ca.body&&ca.body.scrollWidth||0;this.$ContextualBlind7(this.$ContextualBlind3[0],new l(0,da,ba.t,0,'document'));this.$ContextualBlind7(this.$ContextualBlind3[1],new l(ba.t,da,ba.b,ba.r,'document'));this.$ContextualBlind7(this.$ContextualBlind3[2],new l(ba.b,da,aa,0,'document'));this.$ContextualBlind7(this.$ContextualBlind3[3],new l(ba.t,ba.l,ba.b,0,'document'));if(this.$ContextualBlind5)this.$ContextualBlind7(this.$ContextualBlind5,ba);};function u(){'use strict';}u.STYLE_LIGHT=q;u.STYLE_DARK=r;f.exports=u;},null);
__d('ContextualBlindSingleton',['ContextualBlind'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('TourAutoPilot',['ContextualBlindSingleton','DOMScroll','Tour'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=babelHelpers.inherits(m,j);l=k&&k.prototype;m.prototype.registerStep=function(n,o){'use strict';n.subscribe('tour-dialog-show',this.handleShowDialog.bind(this,n,o));l.registerStep.call(this,n,o);};m.prototype.handleLeavePage=function(){'use strict';this.openDialog&&this.openDialog.destroy();this.hideContextualBlind();l.handleLeavePage.call(this);};m.prototype.handleShowDialog=function(n,o){'use strict';var p=n.getContext();this.showContextualBlind(p,true);i.scrollTo(p,true,true,0);};m.prototype.handleTourStop=function(){'use strict';this.hideContextualBlind(true);l.handleTourStop.call(this);};m.prototype.showContextualBlind=function(n,o){'use strict';if(this.blindShowing){h.show(n,0,0,0,0,o,this.opacity);}else h.fadeIn(n,0,0,0,0,o,this.opacity);this.blindShowing=true;};m.prototype.hideContextualBlind=function(n){'use strict';if(n){h.fadeOut();}else h.hide();this.blindShowing=false;};function m(){'use strict';k.apply(this,arguments);}Object.assign(m.prototype,{blindShowing:false,opacity:null});g.TourAutoPilot=m;},null);
__d('ComposerTour',['Arbiter','AsyncRequest','ComposerCitySharer','CSS','DOM','Parent','Tour','URI','$','TourAutoPilot'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r,s=c('TourAutoPilot').TourAutoPilot;q=babelHelpers.inherits(t,s);r=q&&q.prototype;t.prototype.handleShowDialog=function(u,v){'use strict';var w=m.byClass(p('composerTourStart'),'uiComposer');if(v!='start'){r.handleShowDialog.call(this,u,v);this.showContextualBlind(w);}};t.prototype.showContextualBlind=function(u){'use strict';k.addClass(document.body,'composerTourInProgress');r.showContextualBlind.call(this,u);};t.prototype.hideContextualBlind=function(u){'use strict';r.hideContextualBlind.call(this,u);k.removeClass(document.body,'composerTourInProgress');};t.openComposer=function(){'use strict';var u=m.byClass(p('composerTourStart'),'uiComposerAttachment'),v=m.byTag(u,'form');v.action=u.getAttribute('data-endpoint');v.xhpc.value=u.id;v.xhpc.click();};t.closeOnComposerReset=function(){'use strict';h.subscribe('composer/reset',function(){n.getInstance().setTourStop();});};t.sendLocationOption=function(u,v){'use strict';var w=new o(v).addQueryData({use_location:u});new i(w.toString()).send();};t.addCity=function(){'use strict';var u=m.byClass(p('composerTourLocation'),'uiComposer'),v=j.getInstance(l.scry(u,'span.ComposerCitySharer')[0]);v&&v.useDefaultCity();};t.clearCity=function(){'use strict';var u=m.byClass(p('composerTourLocation'),'uiComposer'),v=j.getInstance(l.scry(u,'span.ComposerCitySharer')[0]);v&&v.clearCity();};t.hideStartDialog=function(){'use strict';var u=n.getInstance().steps.start;u&&u.hide();};function t(){'use strict';q.apply(this,arguments);}f.exports=t;},null);
__d('legacy:composer-tour-js',['ComposerTour'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.ComposerTour=c('ComposerTour');},3);