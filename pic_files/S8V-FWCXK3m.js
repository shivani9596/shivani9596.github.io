/*!CK:3001868735!*//*1442198793,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["YTrAg"]); }

__d('MessengerForwardAttachmentDialog.react',['AsyncRequest','CurrentUser','Image.react','immutable','LayerFadeOnHide','MessengerComposeViewHeader.react','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','MessengerDialogTitle.react','MessengerSpinner.react','React','XMessagingForwardAttachmentController','cx','emptyFunction','fbt','xuiglyph'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba=v.PropTypes,ca=v.createClass({displayName:'MessengerForwardAttachmentDialog',propTypes:{attachmentID:ba.string.isRequired,onClose:ba.func,shown:ba.bool.isRequired,title:ba.string.isRequired},getInitialState:function(){return {recipients:k.List(),sendError:null,sending:false,startingThreadingID:Date.now()};},render:function(){var da=z._("Send"),ea;if(this.state.sending){ea=v.createElement('div',null,v.createElement(u,null),v.createElement('span',{className:"_1e1n _3-99"},z._("Sending")));}else if(this.state.sendError){var fa=aa({name:'error-solid',shade:'dark',size:'medium'});ea=v.createElement('div',{className:"_1e1n"},v.createElement(j,{src:fa}),v.createElement('span',{className:"_3-99"},this.state.sendError));}return (v.createElement(n,{shown:this.props.shown,behaviors:{LayerFadeOnHide:l},onToggle:this._handleToggle,width:560},v.createElement(s,null,v.createElement(t,null,this.props.title)),v.createElement(o,null,v.createElement(m,{className:"_1e1o",onAddRecipient:this._handleAddRecipient,onRemoveRecipient:this._handleRemoveRecipient,onResize:y,recipients:this.state.recipients,viewer:i.getID()})),v.createElement(r,{leftContent:ea},v.createElement(q,{onClick:this.props.onClose}),v.createElement(p,{action:'confirm',disabled:!this.state.recipients.size||this.state.sending,label:da,onClick:this._handleSubmit,type:'primary'}))));},_handleAddRecipient:function(da){this.setState({recipients:this.state.recipients.push(da)});},_handleRemoveRecipient:function(da){var ea=this.state.recipients;this.setState({recipients:ea['delete'](ea.indexOf(da))});},_handleSubmit:function(){var da={},ea=this.state.startingThreadingID;this.state.recipients.forEach(function(ga){da[ea++]=ga.getUniqueID();});var fa=w.getURIBuilder().getURI();new h(fa).setMethod('POST').setHandler(this._handleSubmitResponse).setData({attachment_id:this.props.attachmentID,recipient_map:da}).send();this.setState({sending:true,sendError:null});},_handleSubmitResponse:function(da){if(da.payload.success){this.props.onClose&&this.props.onClose();this.setState({recipients:k.List(),sending:false,startingThreadID:Date.now()});return;}this.setState({sending:false,sendError:da.payload.error});},_handleToggle:function(da){if(!da)this.props.onClose&&this.props.onClose();}});f.exports=ca;},null);