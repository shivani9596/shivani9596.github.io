/*!CK:2590664997!*//*1442817747,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["aHgR8"]); }

__d('StarsRatableBase',['Event','Arbiter','CSS','DOM','Parent','Run'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(o,p,q,r){this.root=o;this.freezeOnClick=p;this.stars=k.scry(o,'a');this.listeners=[h.listen(this.root,'click',this._onClick.bind(this)),h.listen(this.root,'mousemove',this._onMouseMove.bind(this)),h.listen(this.root,'mouseout',this._onMouseOut.bind(this))];this.holdMouseMove=false;this.setRating(q);this.defaultRating=q;this.resetOnLayerHide=r;this.composerArbiters=[];m.onLeave(this.destroyListeners.bind(this));}n.init=function(o,p,q,r){return new n(o,p,q,r);};Object.assign(n.prototype,{_onClick:function(event){this.layerHides=0;var o=this._getStarIndexFromEvent(event);if(!o)return;this.setRating(o);if(this.freezeOnClick){this.freeze();}else this.holdMouseMove=true;if(this.resetOnLayerHide)this.composerArbiters=[i.subscribe('saving_rating_from_composer',(function(p,q){this.defaultRating=q;this.setRating(q);this._unsubscribeComposerArbiters();}).bind(this)),i.subscribe('canceling_from_composer',(function(){this.setRating(this.defaultRating);this._unsubscribeComposerArbiters();}).bind(this))];event.prevent();},_unsubscribeComposerArbiters:function(){for(var o=0;o<this.composerArbiters.length;++o)i.unsubscribe(this.composerArbiters[o]);this.composerArbiters=[];},_onMouseMove:function(event){if(this.holdMouseMove)return;var o=this._getStarIndexFromEvent(event);if(!o)return;this.setStars(o,true);},_onMouseOut:function(event){this.holdMouseMove=false;this.updateStars();},_getStarIndexFromEvent:function(event){var o=l.byTag(event.getTarget(),'a');if(o)return this.stars.indexOf(o)+1;return 0;},setRating:function(o){this._rating=o;this.updateStars();},updateStars:function(){this.setStars(this._rating);},setStars:function(o,p){var q=p?'hoverStar':'fullStar',r=p?'fullStar':'hoverStar';for(var s=0;s<this.stars.length;++s){j.removeClass(this.stars[s],r);var t=s>=o;j.conditionClass(this.stars[s],q,!t);j.conditionClass(this.stars[s],'emptyStar',t);}},freeze:function(){j.addClass(this.root,'uiStarsRated');this.destroyListeners();},destroyListeners:function(){this.listeners.forEach(function(o){o&&o.remove();});this.listeners=[];}});b.StarsRatableBase=f.exports=n;},null);
__d('LocalContentClickLogger',['BanzaiLogger','EventListener'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();j.prototype.initClickThroughLogging=function(k,l,m){'use strict';i.listen(k,'click',(function(){return this.sendLoggingRequest(l,m);}).bind(this));};j.prototype.initMenuClickLogging=function(k,l,m,n){'use strict';k.subscribe('itemclick',(function(o,p){if(p.item.getValue()==l)this.sendLoggingRequest(m,n);}).bind(this));};j.prototype.initPrivacyMenuClickLogging=function(k,l,m){'use strict';i.listen(k,'click',(function(event){l.button_text=event.target.textContent;this.sendLoggingRequest(l,m);}).bind(this));};j.prototype.sendLoggingRequest=function(k,l){'use strict';if(l=='reviews'){h.log('ReviewConsumptionLoggerConfig',k);}else if(l=='review_production'){h.log('ReviewProductionLoggerConfig',k);}else if(l=='menus')h.log('MenuConsumptionLoggerConfig',k);};function j(){'use strict';}f.exports=new j();},null);
__d('ReviewsController',['Arbiter','Dialog','Event','React','ReactDOM','Image.react','Run','DOM','csx','fbt','ix','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t={},u={},v={},w={},x={},y={registerRevealProfanity:function(z,aa,ba){j.listen(aa,'click',function(){z.style.display='none';ba.style.display='inline';});},registerButton:function(z,aa){t[aa]=t[aa]||[];t[aa].push(z);},registerViewerReview:function(z,aa){u[aa]=u[aa]||[];u[aa].push(z);},registerComposer:function(z,aa){v[aa]=v[aa]||[];v[aa].push(z);},registerToggle:function(z,aa,ba,ca){w[z]=w[z]||[];w[z].push([aa,ba,ca]);},addUserReview:function(z,aa,ba,ca,da,ea,fa,ga){this._updateState(true,z,aa,ba,ca,da,ea,fa,ga);},deleteUserReview:function(z,aa,ba,ca,da,ea){this._updateState(false,z,null,null,null,aa,ba,ca,ea);if(da){var fa=document.getElementById(da),ga=fa.parentNode.parentNode;ga.parentNode.removeChild(ga);}},_updateState:function(z,aa,ba,ca,da,ea,fa,ga,ha){var ia;if(ha){var ja=s('viewer_own_review_tab');if(ja)o.replace(ja,ha);}else if(z){var ka=s('page_reviews_tab_list');if(ka)o.prependContent(ka,ca);}var la=u[aa]||[];for(ia=0;ia<la.length;ia++)o.remove(la[ia]);var ma=w[aa]||[];for(ia=0;ia<ma.length;ia++){var na=ma[ia],oa=na[z?1:2];o.setContent(na[0],oa);}var pa=v[aa]||[];for(ia=0;ia<pa.length;ia++){var qa=pa[ia];if(z){qa.hide();}else{qa.clear();qa.show();}}var ra=t[aa]||[];for(ia=0;ia<ra.length;ia++){var sa=ra[ia],ta=o.find(sa,'.uiButtonText'),ua=o.find(sa,'i'),va,wa;if(z){va=r('/images/icons/buttons/check.png');wa=q._("Reviewed");}else{va=r('/images/icons/buttons/feature.png');wa=q._("Review");}var xa=o.create('span'),ya={"padding-right":"5px"};l.render(k.createElement('div',null,wa),ta);l.render(k.createElement(m,{src:va,style:ya}),xa);o.replace(ua,xa);}if(z){var za=o.scry(document,'#page_recommendations_browse_list')[0];if(za)o.prependContent(za,ba);var ab="ul._1rhx",bb=o.scry(document,ab)[0];if(bb)o.prependContent(bb,da);}if(ea){var cb=s('page_reviews_pill_and_histogram');if(cb)o.replace(cb,ea);}if(fa){var db=s('pages_inline_rating_summary');if(db)o.replace(db,fa);}if(ga){var eb=s('pages_review_needy_place_card');if(eb)o.replace(eb,ga);}},registerPhotoUpload:function(z,aa){h.subscribe('multi-upload/images-upload-completed/'+aa,function(){x[aa]=false;});h.subscribe('multi-upload/images-upload-start/'+aa,function(){x[aa]=true;});j.listen(z,'submit',(function(){if(x[aa]){new i().setTitle(q._("Photos Are Uploading")).setSemiModal(true).setButtons(i.OK).setBody(q._("Please wait until photo is uploaded before posting.")).show();return false;}return true;}).bind(this));}};n.onLeave(function(){t={};u={};v={};w={};x={};});f.exports=y;},null);